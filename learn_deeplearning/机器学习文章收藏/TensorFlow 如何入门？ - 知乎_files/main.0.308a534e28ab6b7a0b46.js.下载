webpackJsonp([0],{1140:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){return{notification:e.notification[N.NOTIFICATION_TYPE_COMMENT]||{}}}Object.defineProperty(t,"__esModule",{value:!0});var u,c,d,f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},m=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),p=n(1),h=a(p),b=n(0),v=a(b),y=n(3),E=n(2),C=a(E),g=n(138),O=a(g),_=n(346),N=n(16),w=n(6),k=n(1718),T=a(k),P=n(1738),I=a(P),M=(c=u=function(e){function t(e){o(this,t);var n=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));d.call(n);var a=e.parent,r=e.dispatch;return n.like=function(e){return r((0,_.updateCommentLikeStatus)(e))},n.feature=function(e,t){return r((0,_.updateCommentFeatureStatus)(e,a.id,a.type,t))},n.delete=function(e){return r((0,_.deleteComment)(e,a.type,a.id))},n.showConversation=function(e){return n.setState({openedCommentId:e})},n.showComments=function(){return n.setState({openedCommentId:null})},n}return i(t,e),m(t,[{key:"render",value:function(){var e=this.props,t=e.parent,n=e.commentPattern,a=e.type,o=e.parent,l=o.commentPermission,i=o.author,s=e.notification,u=r(e,["parent","commentPattern","type","parent","notification"]),c=this.context.currentUser,d=i&&c&&i.urlToken===c.urlToken,m="censor"===l&&!d,p="answer"===a||"article"===a,h=this.state,b=h.openedCommentId,y=h.status,E=h.order,g={commentNeedsReview:m,parent:t,type:a,canOperateItem:p,onShowConversation:this.showConversation,onItemLike:this.like,onItemFeature:this.feature,onItemDelete:this.delete,onItemCollapse:this.collapse,onItemDislike:this.dislike,onItemApprove:this.approve};return v.default.createElement("div",{className:"Comments-container"},v.default.createElement(O.default,{notification:s,delay:w.NOTIFICATION_DELAY,className:(0,C.default)("Comments-notification",{"Comments-notification--mobile":!1,"Comments-notification--bottom":"bottom"===n})}),v.default.createElement(T.default,f({},u,g,{commentPattern:n,className:(0,C.default)({"Comments--hidden":b&&"bottom"!==n}),order:E,status:y,onStatusChange:this.handleStatusChange,onOrderChange:this.handleOrderChange,isAuthor:d})),b&&v.default.createElement(I.default,f({},u,g,{commentPattern:n,commentId:b,onNavBack:this.showComments})))}}]),t}(b.Component),u.contextTypes={currentUser:h.default.object,authRequired:h.default.func.isRequired},d=function(){var e=this;this.state={openedCommentId:null,status:"open",order:"normal"},this.collapse=function(t){var n=e.props,a=n.dispatch,r=n.parent;a((0,_.updateCommentCollapsed)(t,r.type,r.id))},this.dislike=function(t){return e.props.dispatch((0,_.updateCommentDisliked)(t))},this.approve=function(t){var n=e.props,a=n.dispatch,r=n.parent,o=n.type;a((0,_.approveComment)(t,o,r.id))},this.handleStatusChange=function(t){e.setState({status:t})},this.handleOrderChange=function(t){e.setState({order:t})}},c);M.propTypes={type:h.default.string,parent:h.default.object.isRequired},M.defaultProps={type:"answer"},t.default=(0,y.connect)(s)(M)},1141:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FavlistsModal=void 0;var a=n(1719),r=function(e){return e&&e.__esModule?e:{default:e}}(a);t.FavlistsModal=r.default},1142:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReportModal=void 0;var a=n(1726),r=function(e){return e&&e.__esModule?e:{default:e}}(a);t.ReportModal=r.default},1143:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){var t=e.length;return e.map(function(e,n){return c.default.createElement("span",{key:n},c.default.createElement(h.default,{user:e,noHoverCard:!0,noBadge:!0}),n!==t-1&&c.default.createElement("span",{style:{color:"rgb(62,122,194)"}},"、"))})}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n(0),c=a(u),d=n(2),f=a(d),m=n(6),p=n(20),h=a(p);n(362);var b=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,e),s(t,[{key:"renderCommentButton",value:function(e,t){var n=this,a=t.href,r=t.byComment;return c.default.createElement("a",{href:a+(r?"#comment-"+r:""),onClick:function(e){e.preventDefault(),n.props.onCommentsModalOpen(t)}},e)}},{key:"render",value:function(){var e=this.props,t=e.item,n=t.id,a=t.actionCount,r=t.actionName,o=t.groupName,l=t.operators,s=t.target,u=t.column,d=t.answer,p=t.isRead,h=t.voteCount,b=t.thankCount,v=t.question,y=t.comment,E=e.onClickLink,C=y&&y.id,g=r.includes("REPLY_IN"),O=void 0,_=void 0,N=void 0,w=void 0;switch(o){case"QUESTION":O=i(l),_=c.default.createElement("span",null," 修改了问题 ");var k=s.title,T=s.id;N=c.default.createElement("a",{href:"/question/"+T+"/log/self?group_id="+n},k);break;case"ANSWER_SUMMARY":O=i(l),_=c.default.createElement("span",null," 编辑了 ");var P=s.id,I=s.question,M=I.title,R=I.id;N=c.default.createElement("a",{href:"/question/"+R+"/answer/"+P},M),w=c.default.createElement("span",null," 的回答总结");break;case"INVITE":O=i(l),_=c.default.createElement("span",null," 邀请你回答 ");var S=s.title,j=s.id;N=c.default.createElement("a",{href:"/question/"+j},S);break;case"ANSWER":O=i(l),_=c.default.createElement("span",null," 回答了 ");var L=s.title,A=s.id;N=c.default.createElement("a",{href:"/question/"+A+(d?"/answer/"+d.id:"?group_id="+n)},L);break;case"QUESTION_COMMENT":O=i(l),_=c.default.createElement("span",null," ",g?"回复了你在":"评论了"," ");var B=s.title,D=s.id;N=this.renderCommentButton(B,{type:"question",href:"/question/"+D,byComment:C,target:s}),g&&(w=c.default.createElement("span",null," 下的评论"));break;case"ANSWER_COMMENT":case"ANSWER_COMMENT_REPLY":O=i(l),_=c.default.createElement("span",null," ",g?"回复了你在":"评论了"," ");var F=s.question,q=F.title,x=F.id,U=s.id;N=this.renderCommentButton(q,{type:"answer",href:"/question/"+x+"/answer/"+U,byComment:C,target:s}),g&&(w=c.default.createElement("span",null," 下的评论"));break;case"FAVLIST_COMMENT":case"FAVLIST_COMMENT_REPLY":O=i(l),_=c.default.createElement("span",null," ",g?"回复了你在":"评论了"," ");var W=s.title,z=s.id;N=this.renderCommentButton(W,{type:"collection",href:"/collection/"+z+"?group_id="+n,byComment:C,target:s}),g&&(w=c.default.createElement("span",null," 下的评论"));break;case"ANSWER_MENTION":O=i(l),_=c.default.createElement("span",null," 在 ");var K=s.id,V=s.question,Y=V.id,H=V.title;N=c.default.createElement("a",{href:"/question/"+Y+"/answer/"+K},H),w=c.default.createElement("span",null," 中提到了你");break;case"QCOMMENT_MENTION":O=i(l),_=c.default.createElement("span",null," 在 ");var G=s.title,Q=s.id;N=this.renderCommentButton(G,{type:"question",href:"/question/"+Q,byComment:C,target:s}),w=c.default.createElement("span",null," 中提到了你");break;case"ACOMMENT_MENTION":O=i(l),_=c.default.createElement("span",null," 在 ");var J=s.question,Z=J.title,$=J.id,X=s.id;N=this.renderCommentButton(Z,{type:"answer",href:"/question/"+$+"/answer/"+X,byComment:C,target:s}),w=c.default.createElement("span",null," 中提到了你");break;case"FCOMMENT_MENTION":O=i(l),_=c.default.createElement("span",null," 在 ");var ee=s.title,te=s.id;N=this.renderCommentButton(ee,{type:"answer",href:"/collection/"+te+"?group_id="+n,byComment:C,target:s}),w=c.default.createElement("span",null," 中提到了你");break;case"ANSWER_COLLAPSE":_=c.default.createElement("span",null," 你在 ");var ne=s.id,ae=s.question,re=ae.id,oe=ae.title;N=c.default.createElement("a",{href:"/question/"+re+"/answer/"+ne},oe),w=c.default.createElement("span",null," 下的回答被折叠");break;case"ANSWER_COLLAPSE_CANCEL":_=c.default.createElement("span",null," 你在 ");var le=s.id,ie=s.question,se=ie.id,ue=ie.title;N=c.default.createElement("a",{href:"/question/"+se+"/answer/"+le},ue),w=c.default.createElement("span",null," 下的回答已恢复正常");break;case"QUESTION_SUGGEST_EDIT":_=c.default.createElement("span",null," 问题 ");var ce=s.title,de=s.id;N=c.default.createElement("a",{href:"/question/"+de},ce),w=c.default.createElement("span",null," 已被「建议修改」，请及时修改问题");break;case"QUESTION_CLOSE":_=c.default.createElement("span",null," 问题 ");var fe=s.title,me=s.id;N=c.default.createElement("a",{href:"/question/"+me},fe),w=c.default.createElement("span",null," 已被「关闭」");break;case"QUESTION_EDIT_REJECT":_=c.default.createElement("span",null," 问题 ");var pe=s.title,he=s.id;N=c.default.createElement("a",{href:"/question/"+he},pe),w=c.default.createElement("span",null,"修改后仍然不符合",c.default.createElement("a",{href:"/question/19806261"},"知乎提问规范"));break;case"QUESTION_NORMAL":_=c.default.createElement("span",null," 问题 ");var be=s.title,ve=s.id;N=c.default.createElement("a",{href:"/question/"+ve},be),w=c.default.createElement("span",null," 已恢复正常");break;case"ANSWER_SUGGEST_EDIT":_=c.default.createElement("span",null," 你在 ");var ye=s.id,Ee=s.question,Ce=Ee.id,ge=Ee.title;N=c.default.createElement("a",{href:"/question/"+Ce+"/answer/"+ye},ge),w=c.default.createElement("span",null," 下的回答已被「建议修改」，请及时修改问题");break;case"ANSWER_EDIT_EVALUATE_REJECT":_=c.default.createElement("span",null," 你在 ");var Oe=s.id,_e=s.question,Ne=_e.title,we=_e.id;N=c.default.createElement("a",{href:"/question/"+we+"/answer/"+Oe},Ne),w=c.default.createElement("span",null," 下的回答修改后仍然不符合知乎内容规范，请及时修改");break;case"ANSWER_NORMAL":_=c.default.createElement("span",null," 你在 ");var ke=s.id,Te=s.question,Pe=Te.id,Ie=Te.title;N=c.default.createElement("a",{href:"/question/"+Pe+"/answer/"+ke},Ie),w=c.default.createElement("span",null," 下的回答已恢复正常");break;case"COLUMN_FOLLOW":O=i(l),_=c.default.createElement("span",null," 关注了 ");var Me=s.title,Re=s.id;N=c.default.createElement("a",{href:m.COLUMN_DOMAIN+"/"+Re+"?group_id="+n},Me);break;case"ARTICLE_CREATE":O=i(l);var Se=s.title,je=s.id;if(u){var Le=u.title,Ae=u.id;_=c.default.createElement("a",{href:m.COLUMN_DOMAIN+"/"+Ae}," 在"+Le+"中 ")}N=c.default.createElement("a",{href:m.COLUMN_DOMAIN+"/p/"+je},"发布了"+Se);break;case"ARTICLE_MENTION":O=i(l);var Be=s.title,De=s.excerptTitle,Fe=s.id,qe=Be||De||"无标题";_=c.default.createElement("span",null," 在 "),N=c.default.createElement("a",{href:m.COLUMN_DOMAIN+"/p/"+Fe},"发布了"+qe),w=c.default.createElement("span",null,"提到了你");break;case"ARTICLE_COMMENT":case"ARTCOMMENT_REPLY":case"ARTCOMMENT_COLUMN":case"ARTCOMMENT_REPLY_COLUMN":case"ARTCOMMENT_COLLECTION":case"ARTCOMMENT_REPLY_COLLECTION":O=i(l),_=c.default.createElement("span",null," ",g?"回复了你在":"评论了"," ");var xe=s.title,Ue=s.excerptTitle,We=s.id,ze=xe||Ue||"无标题";N=this.renderCommentButton(ze,{type:"article",href:m.COLUMN_DOMAIN+"/p/"+We,byComment:C,target:s}),g&&(w=c.default.createElement("span",null," 下的评论"));break;case"COLUMN_INVITE_EDITOR":O=i(l);var Ke=s.title,Ve=s.id;_=c.default.createElement("span",null," 邀请你成为 "),N=c.default.createElement("a",{href:m.COLUMN_DOMAIN+"/"+Ve},Ke),w=c.default.createElement("span",null," 的编辑");break;case"COLUMN_INVITE":case"COLUMN_INVITE_CONTRIBUTOR":case"COLUMN_INVITE_AUTHOR":O=i(l);var Ye=s.title,He=s.id;_=c.default.createElement("span",null," 邀请你成为 "),N=c.default.createElement("a",{href:m.COLUMN_DOMAIN+"/"+He+"?group_id="+n},Ye),w=c.default.createElement("span",null," 的作者");break;case"ARTCOMMENT_MENTION":O=i(l),_=c.default.createElement("span",null," 在 ");var Ge=s.title,Qe=s.id;N=this.renderCommentButton(Ge,{type:"article",href:m.COLUMN_DOMAIN+"/p/"+Qe,byComment:C,target:s}),w=c.default.createElement("span",null," 下的评论中提到了你");break;case"ARTICLE_CONTRIBUTE":O=i(l);var Je=s.id,Ze=s.title;if(u){var $e=u.title,Xe=u.id;_=c.default.createElement("span",null," 向 ",c.default.createElement("a",{href:m.COLUMN_DOMAIN+"/"+Xe+"?group_id="+n},$e)," 投稿了文章 ")}else _=c.default.createElement("span",null," 投稿了文章 ");N=c.default.createElement("a",{href:m.COLUMN_DOMAIN+"/p/"+Je+"?group_id="+n},""+Ze);break;case"ARTICLE_CONTRIBUTE_ACCEPT":var et=s.id,tt=s.title;if(u){var nt=u.title,at=u.id;_=c.default.createElement("span",null,c.default.createElement("a",{href:m.COLUMN_DOMAIN+"/"+at+"?group_id="+n},nt)," 通过了你投稿的文章 ")}else _=c.default.createElement("span",null,"通过了你投稿的文章");N=c.default.createElement("a",{href:m.COLUMN_DOMAIN+"/p/"+et+"?group_id="+n},""+tt);break;case"CANCEL_ARTICLE_CONTRIBUTE":var rt=s.id,ot=s.title;if(u){var lt=u.title,it=u.id;_=c.default.createElement("span",null,c.default.createElement("a",{href:m.COLUMN_DOMAIN+"/"+it+"?group_id="+n},lt)," 取消收录你的文章 ")}_=c.default.createElement("span",null," 取消收录你的文章 "),N=c.default.createElement("a",{href:m.COLUMN_DOMAIN+"/p/"+rt+"?group_id="+n},""+ot);break;case"ARTICLE_APPLY_PUBLISH":O=i(l);var st=s.id,ut=s.title,ct=u.title,dt=u.id;_=c.default.createElement("span",null," 申请向 ",c.default.createElement("a",{href:m.COLUMN_DOMAIN+"/"+dt+"?group_id="+n},ct)," 投稿 "),N=c.default.createElement("a",{href:m.COLUMN_DOMAIN+"/p/"+st+"?group_id="+n},""+ut);break;case"ARTICLE_CANCEL_APPLY_PUBLISH":var ft=s.id,mt=s.title,pt=u.title,ht=u.id;_=c.default.createElement("span",null,c.default.createElement("a",{href:m.COLUMN_DOMAIN+"/"+ht+"?group_id="+n},pt)," 取消收录 "),N=c.default.createElement("a",{href:m.COLUMN_DOMAIN+"/p/"+ft+"?group_id="+n},""+mt);break;case"ARTICLE_PUBLISH":O=i(l);var bt=s.id,vt=s.title;if(u){var yt=u.title,Et=u.id;_=c.default.createElement("span",null," 在 ",c.default.createElement("a",{href:m.COLUMN_DOMAIN+"/"+Et+"?group_id="+n},yt)," 中发布了 ")}else _=c.default.createElement("span",null," 发布了 ");N=c.default.createElement("a",{href:m.COLUMN_DOMAIN+"/p/"+bt+"?group_id="+n},""+vt);break;case"ARTICLE_INVITE_REVIEW":O=i(l),_=c.default.createElement("span",null," 邀请你预览 ");var Ct=s.title,gt=s.id;N=c.default.createElement("a",{href:m.COLUMN_DOMAIN+"/p/"+gt+"?group_id="+n},Ct);break;case"ARTREVIEW_COMMENT":O=i(l),_=c.default.createElement("span",null," 评论了草稿 ");var Ot=s.title,_t=s.id;N=c.default.createElement("a",{href:m.COLUMN_DOMAIN+"/p/"+_t+"?group_id="+n},Ot);break;case"MODIFY_AUTHOR_ROLE_TO_AUTHOR":case"MODIFY_AUTHOR_ROLE_TO_CONTRIBUTOR":O=i(l),_=c.default.createElement("span",null," 变更你为 ");var Nt=s.title,wt=s.id;N=c.default.createElement("a",{href:m.COLUMN_DOMAIN+"/"+wt+"?group_id="+n},Nt),w=c.default.createElement("span",null," 的作者");break;case"MODIFY_AUTHOR_ROLE_TO_EDITOR":O=i(l),_=c.default.createElement("span",null," 变更你为 ");var kt=s.title,Tt=s.id;N=c.default.createElement("a",{href:m.COLUMN_DOMAIN+"/"+Tt+"?group_id="+n},kt),w=c.default.createElement("span",null," 的编辑");break;case"ROUNDTABLE_COMMENT":case"ROUNDTABLE_COMMENT_REPLY":O=i(l),_=c.default.createElement("span",null," ",g?"回复了你在":"评论了"," ");var Pt=s.name,It=s.id;N=this.renderCommentButton(Pt,{type:"roundtable",href:"/roundtable/"+It+"?group_id="+n+"&expand=1",byComment:C,target:s}),g&&(w=c.default.createElement("span",null," 下的评论"));break;case"RTCOMMENT_MENTION":O=i(l),_=c.default.createElement("span",null," 在 ");var Mt=s.name,Rt=s.id;N=this.renderCommentButton(Mt,{type:"roundtable",href:"/roundtable/"+Rt+"?group_id="+n+"&expand=1",byComment:C,target:s}),w=c.default.createElement("span",null," 提到了你");break;case"EBOOK_PUBLISH":O=i(l),_=c.default.createElement("span",null," 的电子书 ");var St=s.title,jt=s.id,Lt=s.ebookType;N=c.default.createElement("a",{href:"/publications/"+Lt+"/"+jt+"?group_id="+n},St),w=c.default.createElement("span",null," 已在知乎书店上架");break;case"EBOOK_VOTE":O=i(l),_=c.default.createElement("span",null," 赞了你的电子书 ");var At=s.title,Bt=s.id,Dt=s.ebookType;N=c.default.createElement("a",{href:"/publications/"+Dt+"/"+Bt+"?group_id="+n},At);break;case"EBOOK_COMMENT":case"EBOOK_COMMENT_REPLY":O=i(l),_=c.default.createElement("span",null," ",g?"回复了你在":"评论了电子书"," ");var Ft=s.type,qt=s.title,xt=s.id,Ut=s.ebookType;N=this.renderCommentButton(qt,{type:Ft,href:"/publications/"+Ut+"/"+xt+"?group_id="+n,byComment:C,target:s}),g&&(w=c.default.createElement("span",null," 下的评论"));break;case"EBOOK_COMMENT_MENTION":O=i(l),_=c.default.createElement("span",null," 在 ");var Wt=s.type,zt=s.title,Kt=s.id,Vt=s.ebookType;N=this.renderCommentButton(zt,{type:Wt,href:"/publications/"+Vt+"/"+Kt+"?group_id="+n,byComment:C,target:s}),w=c.default.createElement("span",null," 中提到了你");break;case"EBOOK_COMMENT_LIKE":O=i(l),_=c.default.createElement("span",null," 赞了你在 ");var Yt=s.title,Ht=s.id,Gt=s.ebookType;N=this.renderCommentButton(Yt,{type:"ebook",href:"/publications/"+Gt+"/"+Ht+"?group_id="+n,byComment:C,target:s}),w=c.default.createElement("span",null," 下的评论");break;case"EBOOK_REVIEW_LIKE":O=i(l);var Qt=s.id,Jt=s.book;_=c.default.createElement("span",null," 赞了你在 "),N=c.default.createElement("a",{href:"/pub/book/"+Jt.id+"/reviews/"+Qt+"?group_id="+n},Jt.title),w=c.default.createElement("span",null," 下的点评 ");break;case"EBOOK_REVIEW_COMMENT":O=i(l);var Zt=s.id,$t=s.book;_=c.default.createElement("span",null," 评论了你在 "),N=c.default.createElement("a",{href:"/pub/book/"+$t.id+"/reviews/"+Zt+"?group_id="+n},$t.title),w=c.default.createElement("span",null," 下的点评 ");break;case"EBOOK_REVIEW_COMMENT_LIKE":O=i(l);var Xt=s.id,en=s.book;_=c.default.createElement("span",null," 赞了你在 "),N=this.renderCommentButton(en.title,{type:"book_review",href:"/pub/book/"+en.id+"/reviews/"+Xt,byComment:C,target:s}),w=c.default.createElement("span",null," 下的评论 ");break;case"EBOOK_REVIEW_COMMENT_REPLY":O=i(l);var tn=s.id,nn=s.book;_=c.default.createElement("span",null," 回复了你在 "),N=this.renderCommentButton(nn.title,{type:"book_review",href:"/pub/book/"+nn.id+"/reviews/"+tn,byComment:C,target:s}),w=c.default.createElement("span",null," 下的评论 ");break;case"PROMOTION_COMMENT":case"PROMOTION_COMMENT_REPLY":O=i(l),_=c.default.createElement("span",null," ",g?"回复了你在":"评论了"," ");var an=s.title,rn=s.id;N=this.renderCommentButton(an,{type:"promotion",href:m.PROMOTION_DOMAIN+"/p/"+rn,byComment:C,target:s}),g&&(w=c.default.createElement("span",null," 下的评论"));break;case"PROMOTION_COMMENT_MENTION":O=i(l),_=c.default.createElement("span",null," 在 ");var on=s.title,ln=s.id;N=this.renderCommentButton(on,{type:"promotion",href:m.PROMOTION_DOMAIN+"/p/"+ln,byComment:C,target:s}),w=c.default.createElement("span",null," 提到了你");break;case"ROUNDTABLE_QUESTION":var sn=s.name,un=s.id,cn=v.id,dn=v.title;O=c.default.createElement("span",null,c.default.createElement("a",{href:"/roundtable/"+un+"?group_id="+n},sn)," 圆桌新增了"+(a>1?"":"问题")+" "),N=c.default.createElement("a",{href:"/question/"+cn+"?group_id="+n},dn),a>1&&(w=c.default.createElement("span",null," 等"+a+"个问题"));break;case"ROUNDTABLE_ANSWER":var fn=s.name,mn=s.id,pn=d.id,hn=d.question,bn=hn.id,vn=hn.title;O=c.default.createElement("span",null,c.default.createElement("a",{href:"/roundtable/"+mn+"?group_id="+n},fn)," 圆桌新增了 ",i(l),(l.length>1?" 等人":"")+" 关于"),N=c.default.createElement("a",{href:"/question/"+bn+"/answer/"+pn},vn),w=c.default.createElement("span",null," 的回答");break;case"MEMBER_FOLLOW_FAVLIST":O=i(l),_=c.default.createElement("span",null," 关注了 ");var yn=s.title,En=s.id;N=c.default.createElement("a",{href:"/collection/"+En+"?group_id="+n},yn);break;case"QCOMMENT_LIKE":O=i(l),_=c.default.createElement("span",null," 赞了你在 ");var Cn=s.title,gn=s.id;N=this.renderCommentButton(Cn,{type:"question",href:"/question/"+gn,byComment:C,target:s}),w=c.default.createElement("span",null," 下的评论");break;case"RTCOMMENT_LIKE":O=i(l),_=c.default.createElement("span",null," 赞了你在 ");var On=s.name,_n=s.id;N=this.renderCommentButton(On,{type:"promotion",href:m.PROMOTION_DOMAIN+"/p/"+_n,byComment:C,target:s}),w=c.default.createElement("span",null," 下的评论");break;case"ACOMMENT_LIKE":O=i(l),_=c.default.createElement("span",null," 赞了你在 ");var Nn=s.question,wn=Nn.title,kn=Nn.id,Tn=s.id;N=this.renderCommentButton(wn,{type:"answer",href:"/question/"+kn+"/answer/"+Tn,byComment:C,target:s}),w=c.default.createElement("span",null," 回答下的评论");break;case"FCOMMENT_LIKE":O=i(l),_=c.default.createElement("span",null," 赞了你在 ");var Pn=s.id,In=s.title;N=this.renderCommentButton(In,{type:"collection",href:"/collection/"+Pn+"?group_id="+n,byComment:C,target:s}),w=c.default.createElement("span",null," 下的评论");break;case"ARTCOMMENT_LIKE":case"ARTCOMMENT_LIKE_COLUMN":case"ARTCOMMENT_LIKE_COLLECTION":O=i(l),_=c.default.createElement("span",null," 赞了你在 ");var Mn=s.title,Rn=s.id;N=this.renderCommentButton(Mn,{type:"article",href:m.COLUMN_DOMAIN+"/p/"+Rn,byComment:C,target:s}),w=c.default.createElement("span",null," 下的评论");break;case"ARTICLE_VOTE":case"ARTVOTE_COLUMN":case"ARTVOTE_COLLECTION":O=i(l);var Sn=s.title,jn=s.excerptTitle,Ln=s.id,An=Sn||jn||"无标题";if(u){var Bn=u.id,Dn=u.title;_=c.default.createElement("span",null," 赞了 ",c.default.createElement("a",{href:m.COLUMN_DOMAIN+"/"+Bn+"?group_id="+n},""+Dn)," 中的文章 ")}else _=c.default.createElement("span",null," 赞了文章 ");N=c.default.createElement("a",{href:m.COLUMN_DOMAIN+"/p/"+Ln+"?group_id="+n},""+An);break;case"ARTICLE_TIPJAR_SUCCESS":O=i(l),_=c.default.createElement("span",null," 赞赏了 ");var Fn=s.title,qn=s.excerptTitle,xn=s.id,Un=Fn||qn||"无标题";N=c.default.createElement("a",{href:m.COLUMN_DOMAIN+"/p/"+xn+"?group_id="+n},""+Un);break;case"ANSWER_REWARD":O=i(l),_=c.default.createElement("span",null," 赞赏了 ");var Wn=s.question,zn=Wn.id,Kn=Wn.title,Vn=s.id;N=c.default.createElement("a",{href:"/question/"+zn+"/answer/"+Vn},""+Kn);break;case"PROMOTION_COMMENT_LIKE":O=i(l),_=c.default.createElement("span",null," 赞了你在 ");var Yn=s.title,Hn=s.id;N=this.renderCommentButton(Yn,{type:"article",href:m.PROMOTION_DOMAIN+"/p/"+Hn,byComment:C,target:s}),w=c.default.createElement("span",null," 下的评论");break;case"VOTE_THANK":_=c.default.createElement("span",null,"获得"+(h?" "+h+" 次赞同":"")+(h&&b?"/":"")+(b?" "+b+" 次感谢 ":" "));var Gn=s.question,Qn=Gn.title,Jn=Gn.id,Zn=s.id;N=c.default.createElement("a",{href:"/question/"+Jn+"/answer/"+Zn},Qn),w=c.default.createElement("span",null," 来自 ",i(l));break;case"PIN_LIKE":O=i(l),_=c.default.createElement("span",null," 赞了你的想法 ");var $n=s.excerptTitle,Xn=s.id;N=c.default.createElement("a",{href:"/pin/"+Xn,target:"_blank"},$n);break;case"PINCOMMENT_REPLY":case"PIN_COMMENT":O=i(l),_=c.default.createElement("span",null," ",g?"回复了你在":"评论了"," ");var ea=s.excerptTitle,ta=s.id;N=this.renderCommentButton(ea,{type:"pin",href:"/pin/"+ta,byComment:C,target:s}),g&&(w=c.default.createElement("span",null," 下的评论"));break;case"PINCOMMENT_MENTION":O=i(l),_=c.default.createElement("span",null," 在 ");var na=s.excerptTitle,aa=s.id;N=this.renderCommentButton(na,{type:"pin",href:"/pin/"+aa,byComment:C,target:s}),w=c.default.createElement("span",null," 中提到了你");break;case"PINCOMMENT_LIKE":O=i(l),_=c.default.createElement("span",null," 赞了你在 ");var ra=s.excerptTitle,oa=s.id;N=this.renderCommentButton(ra,{type:"pin",href:"/pin/"+oa,byComment:C,target:s}),w=c.default.createElement("span",null," 下的评论")}return c.default.createElement("div",{className:(0,f.default)("PushNotifications-item",{"PushNotifications-newItem":!p})},c.default.createElement("span",{onClick:E},O),_,c.default.createElement("span",{onClick:E},N),w)}}]),t}(u.Component);t.default=b},1144:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.TipjarDialog=void 0;var i,s,u=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),c=n(0),d=a(c),f=n(1),m=a(f),p=n(2),h=a(p),b=n(4),v=a(b),y=n(19),E=a(y),C=n(1739),g=a(C),O=n(1745),_=n(6);n(1746);var N=[200,500,1e3,5e3,1e4,2e4],w=100;t.TipjarDialog=(s=i=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onConfirmPayment=function(e){n.setState({chosePaymentName:e})},n.onPaySuccess=function(){n.props.onPaySuccess(),n.setState({chosePaymentName:!0,colseTijarDialogStatus:!0,trade:void 0,currentAmount:"",customButton:!1})},n.handleCustomAmount=function(){n.state.trade&&n.state.trade.dispose(),n.setState({showCustom:!0})},n.handleCustomChange=function(e){var t=e.target.value;Number(t)?n.setState({customAmount:Number(t)}):t.length||n.setState({customAmount:""})},n.handleCustomKeyUp=function(e){13===e.keyCode&&n.handleSubmitCustom()},n.handleSubmitCustom=function(){var e=n.state.customAmount*w;e>0&&e<5e4&&(n.setState({customButton:!0,showCustom:!1,colseTijarDialogStatus:!1}),n.createTrade(e))},n.closeModal=function(){n.state.trade&&n.state.trade.dispose(),n.setState(n.getDefaultState())},n.handleAmountButton=function(e){n.createTrade(e.currentTarget.dataset.amount),n.setState({colseTijarDialogStatus:!1,customButton:!1,showCustom:!1})},n.createTrade=function(e){n.setState({tradeLoading:!0,currentAmount:e});var t=n.props.ua;n.props.addReward(e,t.Wechat?"wechat":"normal"),n.setState({tradeLoading:!1})},n.colseTijarDialog=function(){n.setState({chosePaymentName:!0,colseTijarDialogStatus:!0,trade:void 0,currentAmount:""}),n.props.colseTijarDialog()},n.state=n.getDefaultState(),n}return l(t,e),u(t,[{key:"componentDidMount",value:function(){this.showTip()}},{key:"componentDidUpdate",value:function(){var e=this.props.tradeNumber,t=this.state,n=t.trade,a=t.colseTijarDialogStatus;if(e&&(!n||e!==n.tradeNo)&&!a){var r=new window.zhihu.pay.Trade(e,17);this.setState({trade:r})}}},{key:"componentWillUnmount",value:function(){this.props.TipjarRender&&this.props.removeTradeNumber()}},{key:"getDefaultState",value:function(){return{showCustom:!1,customAmount:"",currentAmount:"",showTipModal:!1,customButton:!1,chosePaymentName:!0,colseTijarDialogStatus:!1}}},{key:"showTip",value:function(){var e=this;(0,O.loadPaySDK)("https://pay.zhihu.com/api/js",function(){e.setState({showTipModal:!0})})}},{key:"renderAmountCustom",value:function(){var e=this.state,t=e.showCustom,n=e.customAmount,a=e.currentAmount,r=e.customButton;return d.default.createElement("div",{className:"Reward-TipjarDialog-amountCustom"},t?d.default.createElement("div",{className:"Reward-TipjarDialog-amountInput"},d.default.createElement("input",{name:"",type:"text",className:"SimpleInput",placeholder:"你想赞赏的金额（不超过 500）",value:n,onChange:this.handleCustomChange,onKeyUp:this.handleCustomKeyUp,ref:function(e){e&&e.focus()}}),d.default.createElement(v.default,{disabled:n<=0||n>500,color:"blue",preset:"primary",onClick:this.handleSubmitCustom},"确定"),d.default.createElement("div",{className:"Reward-TipjarDialog-error",style:{display:n>2e4?"block":"none"}},"不能超过 20000 元")):d.default.createElement(v.default,{preset:"plain",className:r?"TipjarDialog-customButton-cheked":"TipjarDialog-customButton",onClick:this.handleCustomAmount},r?"自定义金额： ￥ "+a/w:"自定义金额"))}},{key:"renderTipjarDialog",value:function(){var e=this,t=this.props,n=t.author,a=n.name,r=n.avatarUrl,o=n.isOrg,l=n.urlToken,i=n.id,s=t.tagline,u=this.state.currentAmount;return d.default.createElement("div",{className:"Reward-TipjarDialog"},d.default.createElement("div",{className:"Reward-TipjarDialog-user"},d.default.createElement("a",{href:"/"+(o?"org":"people")+"/"+(l||i),className:"Reward-UserAvatar"},d.default.createElement("img",{src:r.replace("_is","_l"),className:"Reward-Avatar",alt:"当前用户"})),a),d.default.createElement("div",{className:"Reward-TipjarDialog-tagLine"},s),d.default.createElement("div",{className:"Reward-TipjarDialog-selectAmount"},d.default.createElement("div",{className:"Reward-TipjarDialog-amountList"},N.map(function(t){return d.default.createElement(v.default,{key:t,"data-amount":t,onClick:e.handleAmountButton,color:"red",className:(0,h.default)({"Reward-Button-checked":Number(u)===t})},d.default.createElement("b",null,Number(u)===t?t/w+" 元":"￥ "+t/w))})),this.renderAmountCustom()))}},{key:"render",value:function(){var e=this.props,t=e.ua,n=e.TipjarRender,a=this.state,r=a.showCustom,o=a.tradeLoading,l=a.showTipModal,i=a.trade,s=a.chosePaymentName;return d.default.createElement(E.default,{overlay:!0,onClose:this.colseTijarDialog,className:"Reward-TipjarDialogModal"},n&&d.default.createElement("div",null,l&&s&&this.renderTipjarDialog(),(i||o)&&!r&&d.default.createElement(g.default,{trade:i,ua:t,onSuccess:this.onPaySuccess,onConfirmPayment:this.onConfirmPayment})))}}]),t}(c.Component),i.PropTypes={author:m.default.object,tagline:m.default.string,colseTijarDialog:m.default.func,addReward:m.default.func,tradeNumber:m.default.number,removeTradeNumber:m.default.func,onPaySuccess:m.default.func},i.defaultProps={tagline:_.DEFAULT_REWARD_TAGLINE},s)},1216:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i,s,u,c,d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),m=n(1),p=a(m),h=n(0),b=a(h),v=n(3),y=n(2),E=a(y),C=n(4),g=a(C),O=n(31),_=(a(O),n(143),n(8)),N=a(_),w=n(144),k=n(145),T=a(k),P=n(16);n(85);n(1725);var I=(i=(0,v.connect)(function(e){return{edition:e.env.edition}}))((c=u=function(e){function t(e,n){r(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return a.handleCommentShow=a.context.authRequired(function(){a.setState({shown:!0}),a.hiddenInput.focus()}),a.handleCommentHide=function(){a.setState({shown:!1})},a.handleMobileComment=function(){a.onSubmit(),a.handleCommentHide()},a.onChange=a.handleChange.bind(a),a.onFocus=a.handleFocus.bind(a),a.onBlur=a.handleBlur.bind(a),a.onSubmit=a.context.authRequired(a.handleSubmit.bind(a),void 0,P.NOTIFICATION_TYPE_COMMENT),a.state={active:e.defaultActive,disabled:!0,shown:!1},a}return l(t,e),f(t,[{key:"handleChange",value:function(e){this.setState({disabled:e.isEmpty})}},{key:"handleFocus",value:function(){this.setState({active:!0})}},{key:"handleBlur",value:function(){var e=this;setTimeout(function(){return e.setState({active:!1})},100)}},{key:"handleSubmit",value:function(){var e=this.props,t=e.replyTo,n=e.onSubmit,a=e.onCancel,r=this.input.toHTML();r&&(n(r,t),N.default.trackEvent(this,{action:"Comment",element:"Button"}),this.input.reset(),a&&a())}},{key:"renderInput",value:function(e){var t=this,n=e.placeholder,a=e.className,r=this.props.autoFocus;return b.default.createElement(T.default,{className:(0,E.default)("CommentEditor-input",a),richtext:!0,large:!0,spread:!0,allowMention:!0,autoFocus:Boolean(!1)||r,outputBlockType:"div",onRef:function(e){t.input=e},placeholder:n,onFocus:this.onFocus,onBlur:this.onBlur,onChange:this.onChange,onSubmit:this.onSubmit,minRows:5})}},{key:"render",value:function(){var e=this.props,t=e.replyTo,n=e.commentNeedsReview,a=e.className,r=e.onCancel,o=e.ownerAuthorIsOrg,l=(e.type,e.id,e.edition,this.state),i=l.active,s=l.disabled,u=(this.context.currentUser,o?"机构":"作者");if(t){var c="回复"+(0,w.space)(t.author.member.name,!1,!0)+(n?"，评论由"+u+"筛选后公开":"");return b.default.createElement("div",{className:(0,E.default)(a,"CommentEditor--inCommentItem",{"CommentEditor--active":i})},this.renderInput({placeholder:c}),b.default.createElement("div",{className:"CommentEditor-actions"},b.default.createElement(g.default,{preset:"plain",onClick:r},"取消"),b.default.createElement(g.default,{preset:"primary",color:"blue",onClick:this.onSubmit,disabled:s},"评论")))}var f="写下你的评论...";n&&(f=o?"已开启预审评论，评论由机构筛选后公开":"评论由作者筛选后显示");var m=((0,E.default)(a,"CommentEditor--normal"),this.state.shown,{preset:"primary",color:"blue",children:"评论",disabled:s});return b.default.createElement("div",{className:(0,E.default)(a,"CommentEditor--normal",{"CommentEditor--active":i})},this.renderInput({placeholder:f}),b.default.createElement(g.default,d({},m,{className:"CommentEditor-singleButton",onClick:this.onSubmit})))}}]),t}(h.Component),u.contextTypes={authRequired:p.default.func,currentUser:p.default.object},s=c))||s;I.defaultProps={defaultActive:!1,replyTo:null,inCommentItem:!1,autoFocus:!0,ownerAuthorIsOrg:!1},I.propTypes={className:p.default.string,defaultActive:p.default.bool,replyTo:p.default.object,inCommentItem:p.default.bool,commentNeedsReview:p.default.bool,canComment:p.default.object,onCancel:p.default.func,onSubmit:p.default.func.isRequired},t.default=I},1288:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){return n&&void 0!==t&&(e||!t)}},1289:function(e,t,n){"use strict";function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.selectedKey,l=void 0===r?"selectedProps":r,i=n.dropedKey,s=void 0===i?"dropedProps":i;return Object.keys(e).reduce(function(n,r){var i=t.includes(r)?l:s;return o({},n,a({},i,o({},n[i],a({},r,e[r]))))},{})}Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};t.selectPairs=r},1290:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.convertType=function(e){return"article"===e?"Post":""+e.slice(0,1).toUpperCase()+e.slice(1)}},1291:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s=n(1),u=a(s),c=n(0),d=a(c),f=n(3),m=n(2),p=a(m),h=n(5),b=a(h),v=n(42),y=(a(v),n(27)),E=n(4),C=a(E),g=n(16),O=n(6),_=n(108),N=a(_),w=n(90),k=n(32),T=a(k),P=n(20),I=a(P),M=n(109),R=a(M),S=n(222),j=(a(S),n(85),n(1216)),L=a(j);n(1735);var A=function(e){function t(){var e,n,a,l;r(this,t);for(var i=arguments.length,s=Array(i),u=0;u<i;u++)s[u]=arguments[u];return n=a=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),a.state={deleteModalShown:!1,reportModalShown:!1,isReplying:!1,collapsed:!0,guideShown:!1},a.getRedirectUrl=function(){var e=a.props.parent;switch(e.type){case"answer":return"/question/"+e.question.id+"/answer/"+e.id;case"article":return"https://zhuanlan.zhihu.com/p/"+e.id;default:return""}},a.like=a.context.authRequired(function(){var e=a.props;(0,e.onLike)(e.comment.id)},O.USER_STATUS_DISALLOWED_MAP.like,g.NOTIFICATION_TYPE_COMMENT),a.dislike=a.context.authRequired(function(){var e=a.props;(0,e.onDislike)(e.comment.id)},O.USER_STATUS_DISALLOWED_MAP.like,g.NOTIFICATION_TYPE_COMMENT),a.delete=function(){var e=a.props;(0,e.onDelete)(e.comment.id)},a.feature=function(){var e=a.props;(0,e.onFeature)(e.comment.id)},a.collapse=function(){var e=a.props;(0,e.onCollapse)(e.comment.id)},a.approve=function(){var e=a.props;(0,e.onApprove)(e.comment.id)},a.showConversation=function(){var e=a.props;(0,e.onShowConversation)(e.comment.id)},a.startReply=a.context.authRequired(function(){a.setState({isReplying:!0},function(){a.editor.onFocus()})},void 0,g.NOTIFICATION_TYPE_COMMENT),a.stopReply=function(){a.setState({isReplying:!1})},a.openModal=function(){a.setState({deleteModalShown:!0})},a.closeModal=function(){a.setState({deleteModalShown:!1})},a.openReportModal=a.context.authRequired(function(){a.setState({reportModalShown:!0})}),a.closeReportModal=function(){a.setState({reportModalShown:!1})},a.handleExpand=function(){a.setState({collapsed:!1})},a.handleToggleGuide=function(){a.setState({guideShown:!a.state.guideShown})},l=n,o(a,l)}return l(t,e),i(t,[{key:"renderRoleInfo",value:function(e,t){return"normal"===e?null:d.default.createElement("span",{className:"CommentItem-roleInfo"},"ancestor"===e||"author"===e&&"question"===t?" (提问者) ":" (作者) ")}},{key:"renderReplyTo",value:function(){var e=this.props.comment,t=e.replyToAuthor,n=e.resourceType;if(!t)return null;var a=t.member,r=void 0===a?{}:a,o=t.role;return d.default.createElement("span",null,d.default.createElement("span",{className:"CommentItem-reply"},"回复"),d.default.createElement(I.default,{className:(0,p.default)({"CommentItem-userLink":!1}),noBadge:!0,noHoverCard:!0,user:r}),this.renderRoleInfo(o,n))}},{key:"renderInner",value:function(){var e=this,t=this.props,n=t.comment,a=n.isDelete,r=n.collapsed,o=t.isConversation,l=t.collapsedShown,i=t.ownerAuthorIsOrg;t.edition;if(a)return o?d.default.createElement("div",{className:"CommentItem-deletedContent"},"这里有一条已删除的评论"):null;if(r&&o)return this.state.collapsed&&!l&&d.default.createElement("div",{className:"CommentItem-deletedContent"},"这里有一条已折叠的评论，",d.default.createElement(C.default,{preset:"plain",onClick:this.handleExpand},"查看"));var s=this.state,u=s.deleteModalShown,c=s.reportModalShown,f=s.isReplying,m=this.props,h=m.parent,v=h.canComment;v=void 0===v?{status:!0}:v;var E=v.status,g=h.questionType,O=m.commentNeedsReview,_=m.comment,k=m.onReply,P=m.status,M=m.type,S=m.canOperate,j=m.commentPattern,A=_.id,B=_.author,D=_.content,F=_.voteCount,q=_.replyToAuthor,x=_.isAuthor,U=_.isParentAuthor,W=_.createdTime,z=_.featured,K=_.voting,V=_.reviewing,Y=_.disliked,H=_.resourceType,G=B||{},Q=G.member,J=G.role,Z=void 0;return Z=f?d.default.createElement(L.default,{commentNeedsReview:O,className:"CommentItem-editor",ref:function(t){e.editor=t},defaultActive:!0,replyTo:_,onCancel:this.stopReply,onSubmit:k}):"reviewing"===P?d.default.createElement("div",{className:"CommentItem-footer"},d.default.createElement(C.default,{preset:"plain",onClick:this.approve},d.default.createElement(b.default,{left:!0,name:"read"}),"公开"),d.default.createElement(C.default,{className:(0,p.default)({"CommentItem-hoverBtn":!0}),preset:"plain",onClick:this.openModal},d.default.createElement(b.default,{left:!0,name:"trash"}),"删除")):d.default.createElement("div",{className:(0,p.default)("CommentItem-footer",{"CommentItem-mobileFooter":!1})},d.default.createElement(C.default,{className:(0,p.default)("CommentItem-likeBtn",K&&"is-liked"),preset:"plain",onClick:this.like,disabled:x},d.default.createElement(b.default,{left:!0,name:"like"}),F>0?F:"赞"),!o&&q&&d.default.createElement(C.default,{preset:"plain",className:"CommentItem-talkBtn",onClick:this.showConversation},d.default.createElement(b.default,{left:!0,name:"comments",width:13}),"查看对话"),!o&&!x&&E&&!r&&d.default.createElement(C.default,{preset:"plain",className:(0,p.default)({"CommentItem-hoverBtn":!0}),onClick:this.startReply},d.default.createElement(b.default,{left:!0,name:"reply"}),"回复"),U&&S&&!0&&d.default.createElement(C.default,{className:(0,p.default)({"CommentItem-hoverBtn":!x}),preset:"plain",onClick:this.feature},d.default.createElement(b.default,{left:!0,name:"recommend"}),z?"取消推荐":"推荐"),U&&S&&!0&&d.default.createElement(C.default,{className:(0,p.default)({"CommentItem-hoverBtn":!x}),preset:"plain",onClick:this.collapse},d.default.createElement(b.default,{left:!0,name:"inconspicuous"}),r?"取消折叠":"折叠"),!U&&!x&&S&&!0&&d.default.createElement(C.default,{className:(0,p.default)({"CommentItem-hoverBtn":!0}),preset:"plain",onClick:this.dislike},d.default.createElement(b.default,{left:!0,name:"like",style:{transform:"rotate(180deg)"}}),Y?"取消踩":"踩"),x||d.default.createElement(N.default,{className:(0,p.default)({"CommentItem-hoverBtn":!0}),resourceType:M,type:"comment",id:A}),(x||U&&"question"!==M||U&&"question"===M&&"commercial"===g)&&!0&&d.default.createElement(C.default,{className:(0,p.default)({"CommentItem-hoverBtn":!x}),preset:"plain",onClick:this.openModal},d.default.createElement(b.default,{left:!0,name:"trash"}),"删除"),!1,!1),d.default.createElement("div",null,d.default.createElement("div",{className:"CommentItem-meta"},Q&&d.default.createElement(I.default,{className:"CommentItem-avatar",avatar:!0,noHoverCard:"fixed"===j,user:Q}),Q&&d.default.createElement(I.default,{className:(0,p.default)({"CommentItem-userLink":!1}),noBadge:!0,noHoverCard:!0,user:Q}),this.renderRoleInfo(J,H),this.renderReplyTo(),V&&d.default.createElement(b.default,{className:"CommentItem-reviewing",name:"inconspicuous","data-tooltip":!1===i?"评论未公开，由作者筛选后显示":"已开启预审评论，评论由机构筛选后公开"}),d.default.createElement("span",{className:"CommentItem-time"},(0,y.toRelativeString)(W))),d.default.createElement(T.default,{className:"CommentItem-content",html:D}),Z,d.default.createElement(R.default,{title:"你确定要删除这条评论吗？",shown:u,onCancel:this.closeModal,onSubmit:this.delete}),d.default.createElement(w.ReportModal,{resourceType:H,type:M,urlToken:A,shown:c,onClose:this.closeReportModal,zaEnabled:!0}))}},{key:"render",value:function(){var e=this.renderInner(),t=this.props.parent;t.type,t.id;return e&&d.default.createElement("div",{className:"CommentItem",ref:this.props.onRef},e,!1)}}]),t}(c.PureComponent);A.propTypes={comment:u.default.object.isRequired,parent:u.default.object.isRequired,commentNeedsReview:u.default.bool,type:u.default.string,isConversation:u.default.bool,onLike:u.default.func.isRequired,onShowConversation:u.default.func,onReply:u.default.func,onFeature:u.default.func,onDelete:u.default.func.isRequired,onCollapse:u.default.func,commentPattern:u.default.string},A.contextTypes={currentUser:u.default.object,authRequired:u.default.func},t.default=(0,f.connect)(function(e){return{edition:e.env.edition}})(A)},1292:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s=n(0),u=a(s),c=n(2),d=a(c),f=n(361),m=a(f),p=n(4),h=a(p),b=n(5),v=a(b),y=n(223),E=a(y);n(1736);var C={normal:{text:"默认排序",value:"reverse"},reverse:{text:"时间排序",value:"normal"}},g=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={text:"时间排序",value:"normal"},n.switchType=n.switchType.bind(n),n}return l(t,e),i(t,[{key:"switchType",value:function(){var e=this.state.value,t=this.props.onOrderChange,n=C[e],a=n.text,r=n.value;this.setState({text:a,value:r}),t(r)}},{key:"renderTitle",value:function(){var e=this.props,t=e.commentCount,n=e.commentClosed,a=e.isConversation,r=e.onNavBack,o=e.targetLink,l=e.isCommentReviewer,i=e.reviewingCounts,s=e.onStatusChange,c=e.status,p=e.commentPattern,b=e.isOrg;return a?u.default.createElement("h2",{className:"CommentTopbar-title"},"bottom"!==p?u.default.createElement(h.default,{className:"CommentTopbar-back",preset:"plain",onClick:r},u.default.createElement(v.default,{className:"CommentTopbar-backIcon",name:"arrowLeft",left:!0,width:14,height:14}),"返回评论"):u.default.createElement("div",null,"查看对话")):l&&!n?u.default.createElement("div",{className:"CommentTopbar-tabsWrapper"},u.default.createElement(m.default,{className:"CommentTopbar-tabs"},u.default.createElement(f.Tab,{className:"CommentTopbar-tab","aria-controls":"CommentTopbar-open",meta:t},u.default.createElement(h.default,{className:(0,d.default)("CommentTopbar-tabButton",{"is-active":"open"===c}),onClick:function(){return s("open")}},"公开评论")),u.default.createElement(f.Tab,{className:"CommentTopbar-tab","aria-controls":"CommentTopbar-reviewing",meta:i},u.default.createElement(h.default,{className:(0,d.default)("CommentTopbar-tabButton",{"is-active":"reviewing"===c}),onClick:function(){return s("reviewing")}},"待"+(b?"审核":"筛选")+"评论"))),o):u.default.createElement("h2",{className:"CommentTopbar-title"},t&&!n?t+" 条评论":"评论",o)}},{key:"renderOptions",value:function(){var e=this.state.text,t=this.props,n=t.isConversation,a=t.commentClosed;return!n&&!a&&u.default.createElement(h.default,{preset:"link",className:(0,d.default)({"CommentTopbar-switch":!0}),onClick:this.switchType},"切换为",e)}},{key:"render",value:function(){return u.default.createElement(E.default,{className:"CommentTopbar",onRef:this.props.onRef,header:this.renderTitle(),options:this.renderOptions()})}}]),t}(s.Component);t.default=g},1718:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){var n=t.parent,a=t.parent,r=a.type,o=a.id,l=t.status,i=t.order,s=t.byComment,u=t.commentPattern,c=e.entities,f=e.comments,m=r+"_"+o,p=f.parent,h=f.pagination;"reviewing"===l&&(h=f.reviewing),"reverse"===i&&(h=f.reverse);var b=[],v=f.collapsed[m]||{};v&&v.ids&&v.ids.length>0&&(b=v.ids.map(function(e){return c.comments[e]}));var y=h[m]||{isPrevDrained:!1,isFetching:!1,isDrained:!1,ids:[]},E=y.isFetching,C=y.isPrevDrained,g=y.isDrained,O=y.ids,_=y.newIds,N=void 0===_?[]:_,w="bottom"!==u?O:N,k=w.map(function(e){return c.comments[e]});return{isFetching:E,isPrevDrained:C,isDrained:g,totals:(f.pagination[m]||{}).totals,comments:k,collapsedInfo:v,collapsedComments:b,targetComment:c.comments[s],parent:d({},n,p[m])}}Object.defineProperty(t,"__esModule",{value:!0});var s,u,c=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},f=n(1),m=a(f),p=n(0),h=a(p),b=n(215),v=a(b),y=n(2),E=a(y),C=n(3),g=n(86),O=n(106),_=a(O),N=n(5),w=a(N),k=n(35),T=a(k),P=n(84),I=a(P),M=n(360),R=a(M),S=n(4),j=a(S),L=n(16),A=n(346),B=n(89),D=a(B),F=n(1216),q=a(F),x=n(1291),U=a(x),W=n(1292),z=a(W);n(1737);var K=(u=s=function(e){function t(e,n){r(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return a.state={collapsed:!0,current:1,packupButtonStatus:!1,packupButtonLeft:0},a.handleOpenCollapsed=function(){a.setState({collapsed:!1}),a.load(a.props,!1,!0)},a.createOnRef=(0,_.default)(function(e){return function(t){var n=a.props.byComment;e===Number(n)&&(a.targetCommentEl=t)}}),a.handlePaginationClick=function(e){a.commentsElement.scrollIntoView(),a.setState({current:e}),a.loadByPagination(e)},a.renderComment=function(e){var t=a.props,n=t.parent,r=n.type,o=n.author;o=void 0===o?{isOrg:!1}:o;var l=o.isOrg,i=t.parent,s=t.commentNeedsReview,u=t.onShowConversation,c=t.status,d=t.onItemLike,f=t.onItemDelete,m=t.onItemCollapse,p=t.onItemDislike,b=t.onItemApprove,v=t.canOperateItem,y=t.commentPattern;return h.default.createElement(U.default,{key:e.id,comment:e,onRef:a.createOnRef(e.id),status:c,type:r,parent:i,canOperate:v,commentNeedsReview:s,onShowConversation:u,ownerAuthorIsOrg:l,onLike:d,onReply:a.addComment,onFeature:a.featureItem,onDelete:f,onCollapse:m,onDislike:p,onApprove:b,commentPattern:y})},a.renderNormalComments=function(e){var t=a.state.collapsed,n=a.props.byComment,r=[];if(a.lastFeaturedIndex=0,e.length>0){var o=e[0].featured,l=!1;e.forEach(function(i,s){if(n||!i.collapsed){var u=e[s-1];if(!i.collapsed||(u&&u.collapsed||r.push(a.renderCollapsedDivider()),!t)){r.push(a.renderComment(i));var c=e[s+1];o&&!l&&i.featured&&(!c||!c.featured)&&(l=!0,a.lastFeaturedIndex=s,r.push(h.default.createElement("div",{className:"CommentList-divider",key:"divider-featured"},h.default.createElement("div",{className:"CommentList-dividerLine"}),h.default.createElement("div",{className:"CommentList-dividerText"},"以上为精选评论",h.default.createElement(w.default,{className:"CommentList-questionMark",name:"questionMark","data-tooltip":"精选评论包含回答作者推荐的评论和部分高赞评论"})))))}}})}return r},a.renderCollapsedComments=function(){var e=[],t=a.props.collapsedComments;return a.state.collapsed||!t||t.length<=0?[]:(e.push(t.map(function(e){return a.renderComment(e)})),e)},a.renderComments=function(e){return e.map(a.renderComment)},a.load=a.load.bind(a),a.loadByPagination=a.loadByPagination.bind(a),a.addComment=a.addComment.bind(a),a.featureItem=a.featureItem.bind(a),a.handleScroll=a.handleScroll.bind(a),a}return l(t,e),c(t,[{key:"componentDidMount",value:function(){this.subscription=(0,g.subscribe)("scroll",this.handleScroll);var e=this.props,t=e.byComment,n=e.commentPattern,a=e.parent.adminClosedComment,r=this.state.current;t&&this.scrollToTarget(),"bottom"!==n||a||(this.loadByPagination(r),this.commentsWithPaginationEl&&this.setState({packupButtonLeft:this.commentsWithPaginationEl.getBoundingClientRect().right-16}))}},{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.order,a=t.status,r=t.targetComment,o=t.commentPattern,l=this.state.current;n===e.order&&a===e.status||("bottom"===o?this.loadByPagination(l,e):this.load(e),this.setState({collapsed:!0}));var i=e.targetComment;!r&&i&&this.setState({collapsed:!i.collapsed})}},{key:"componentDidUpdate",value:function(e){!e.comments.length&&this.props.comments.length&&this.props.byComment&&this.scrollToTarget()}},{key:"componentWillUnmount",value:function(){this.props.dispatch((0,L.clearNotification)(L.NOTIFICATION_TYPE_COMMENT)),this.subscription&&this.subscription.unsubscribe()}},{key:"load",value:function(e,t,n){if(!this.props.isFetching&&!this.props.parent.adminClosedComment){var a=e||this.props,r=a.order,o=a.byComment,l=a.status,i=a.parent,s=i.id,u=i.type,c=a.dispatch,d=a.commentPattern;if(n){c((0,A.loadComments)(u,s,{order:r,isPrevious:t,byComment:o,status:"collapsed",commentPattern:d},!0))}else c((0,A.loadComments)(u,s,{order:r,isPrevious:t,byComment:o,status:l,commentPattern:d}))}}},{key:"addComment",value:function(e,t){var n=this.props,a=n.parent,r=a.id,o=a.type,l=n.dispatch,i=[o,r,e];t&&(i[3]=t.id),l(A.addComment.apply(void 0,i))}},{key:"featureItem",value:function(e){this.props.onItemFeature(e,this.lastFeaturedIndex)}},{key:"handleScroll",value:function(){if(this.commentsElement&&this.commentsWithPaginationEl){var e=window.innerHeight,t=this.state.packupButtonStatus,n=this.commentsWithPaginationEl.getBoundingClientRect(),a=n.top,r=n.bottom,o=n.height;!t&&o>500&&r>e&&a<0?this.setState({packupButtonStatus:!0}):t&&(o<=500||r<=e||a>=0)&&this.setState({packupButtonStatus:!1})}}},{key:"scrollToTarget",value:function(){var e=this.targetCommentEl,t=this.listEl;if(t&&e){var n=e.getBoundingClientRect(),a=n.top,r=n.height,o=t.getBoundingClientRect(),l=o.top,i=o.height;this.listEl.scrollTop+=a-l-(i-r)/2,e.classList.add("CommentItem--highlighted"),setTimeout(function(){return e.classList.remove("CommentItem--highlighted")},2e3)}}},{key:"loadByPagination",value:function(e,t){var n=t||this.props,a=n.order,r=n.byComment,o=n.status,l=n.parent,i=l.id,s=l.type,u=n.dispatch,c=n.commentPattern;u((0,A.loadComments)(s,i,{order:a,isPrevious:!1,byComment:r,status:o,commentPattern:c,current:e}))}},{key:"renderCollapsedDivider",value:function(){var e=this.props,t=e.isDrained,n=e.parent.collapsedCounts;return!t||n<=0?[]:this.state.collapsed?h.default.createElement("div",{className:"CommentList-action",key:"collapsed"},h.default.createElement(j.default,{preset:"plain"},h.default.createElement("span",{onClick:this.handleOpenCollapsed},n," 条评论被折叠"),"（",h.default.createElement("a",{href:"/question/52029856/answer/128623557",target:"_blank"},"为什么？"),"）")):h.default.createElement("div",{className:"CommentList-divider",key:"divider-collapsed"},h.default.createElement("div",{className:"CommentList-dividerLine"}),h.default.createElement("div",{className:"CommentList-dividerText"},n," 条评论被折叠（",h.default.createElement("a",{href:"/question/52029856/answer/128623557",target:"_blank"},"为什么？"),"）"))}},{key:"renderCollapsedInfiLoader",value:function(){var e=this,t=this.state.collapsed;if(t)return[];var n=this.props.collapsedInfo;n=void 0===n?{}:n;var a=n.isFetching,r=n.isPrevDrained,o=n.isDrained;return h.default.createElement(T.default,{className:"CommentList",onRef:function(t){e.listEl=t},isLocal:!0,isLoading:a,isPrevDrained:r,isDrained:o,onLoad:function(n){return e.load(e.props,n,!t)},placeholder:h.default.createElement(k.PlaceHolder,{className:"CommentItem",small:!0})},this.renderCollapsedComments())}},{key:"renderPatternContent",value:function(e){var t=this,n=this.props,a=n.isFetching,r=n.parent,o=r.commentCount,l=r.reviewingCounts,i=r.collapsedCounts,s=void 0===i?0:i,u=r.adminClosedComment,c=n.byComment,d=n.status,f=n.order,m=n.handlePackupButton,p=Math.ceil((o-s)/20),b=this.state,y=b.current,E=b.packupButtonStatus,C=b.packupButtonLeft;return u?null:a?h.default.createElement("div",{ref:function(e){t.commentsWithPaginationEl=e},className:"Comments-pattern-loading"},h.default.createElement(I.default,null)):Boolean(o||l)&&h.default.createElement("div",{ref:function(e){t.commentsWithPaginationEl=e}},h.default.createElement("div",{className:"CommentList"},"normal"===f&&"open"===d?this.renderNormalComments(e):this.renderComments(e)),p>1&&h.default.createElement(R.default,{current:y,className:"comments-pagination",total:p,clickCallback:this.handlePaginationClick}),!c&&this.renderCollapsedDivider(),!c&&this.renderCollapsedInfiLoader(),h.default.createElement(v.default,{transitionName:"Comments-Packup-Button",transitionEnterTimeout:300,transitionLeaveTimeout:300},E&&h.default.createElement("button",{onClick:m,className:"Comments-Packup-Button",style:{left:C}},"收起评论",h.default.createElement(w.default,{name:"arrow"}))))}},{key:"renderModalContent",value:function(e){var t=this,n=this.props,a=n.collapsedInfo,r=n.parent,o=r.commentCount,l=r.adminClosedComment,i=n.status,s=n.order,u=n.byComment,c=this.state.collapsed,f=c?this.props:a,m=f.isFetching,p=f.isDrained,b=f.isPrevDrained;if(p&&o<=0||l)return h.default.createElement("div",{className:"Comments-empty"},h.default.createElement(D.default,{entityType:"comments"}));var v={getContainer:function(e){return e}};return h.default.createElement(T.default,d({className:"CommentList",onRef:function(e){t.listEl=e},isLocal:!0,isLoading:m,isPrevDrained:b,isDrained:p,onLoad:function(e){return t.load(t.props,e,!c)},placeholder:h.default.createElement(k.PlaceHolder,{className:"CommentItem",small:!0})},v),"normal"===s&&"open"===i?this.renderNormalComments(e):this.renderComments(e),!u&&this.renderCollapsedDivider(),!u&&this.renderCollapsedComments())}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,a=t.isAuthor,r=t.comments,o=t.commentPattern,l=t.parent,i=l.canComment;i=void 0===i?{status:!0}:i;var s=i.status,u=i.reason,c=l.author;c=void 0===c?{isOrg:!1}:c;var f=c.isOrg,m=l.type,p=l.id,b=l.commentPermission,v=l.reviewingCounts,y=l.commentCount,C=l.adminClosedComment,g=t.totals,O=t.byComment,_=t.status,N=t.order,w=t.onStatusChange,k=t.onOrderChange,T=t.commentNeedsReview,P=t.targetLink,I=r.filter(function(e){return!e.isDelete}),M="censor"===b&&a,R=M?{isCommentReviewer:M,onStatusChange:w,status:_,reviewingCounts:v}:{},S=C?"当前内容暂时无法评论":u,j=(0,E.default)({Comments:!0,"Comments--withEditor":!0,"Comments-withPagination":"bottom"===o},n);return h.default.createElement("div",{className:j,ref:function(t){e.commentsElement=t}},h.default.createElement(z.default,d({commentCount:y||g,commentClosed:C,targetLink:P,order:N,onOrderChange:k,commentPattern:o,isOrg:f},R)),"bottom"===o?this.renderPatternContent(I):this.renderModalContent(I),s&&!C?h.default.createElement(q.default,{className:"Comments-footer",type:m,id:p,commentNeedsReview:T,onSubmit:this.addComment,autoFocus:!O,ownerAuthorIsOrg:f}):h.default.createElement("div",{className:(0,E.default)("Comments-disabledText",{"Comments-disabledText--fixed":!1})},h.default.createElement("div",{className:"Comments-disabledReason"},S)))}}]),t}(p.Component),s.propTypes={type:m.default.string,parent:m.default.object.isRequired,targetLink:m.default.node,commentNeedsReview:m.default.bool,byComment:m.default.oneOfType([m.default.number,m.default.string]),commentPattern:m.default.string,handlePackupButton:m.default.func},s.contextTypes={authRequired:m.default.func.isRequired},u);t.default=(0,C.connect)(i)(K)},1719:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),c=n(1),d=a(c),f=n(0),m=a(f),p=n(4),h=a(p),b=n(105),v=(a(b),n(19)),y=n(8),E=a(y),C=n(31),g=a(C),O=n(1720),_=a(O),N=n(1721),w=a(N),k=n(1289),T=n(1290),P=n(1288),I=a(P),M=n(1723);a(M);n(1724);var R={list:{title:"添加收藏",tips:function(e){return e?"请选择你想添加的收藏夹":"你可以创建多个收藏夹，将答案分类收藏"}},add:{title:"创建新收藏夹"}},S=function(e){function t(){var e,n,a,r;o(this,t);for(var i=arguments.length,s=Array(i),u=0;u<i;u++)s[u]=arguments[u];return n=a=l(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),j.call(a),r=n,l(a,r)}return i(t,e),u(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.shown,a=t.items,r=t.id,o=t.type,l=t.onFetchRelations,i=e.items,s=e.relations;if(l&&(i.length!==a.length&&e.shown||i.length&&!n&&e.shown)){var u=(s?i.filter(function(e){return!{}.hasOwnProperty.call(s,e.id)}):i).map(function(e){return e.id});u.length&&l(r,o,u)}i.length>a.length&&this.setState({status:"list"})}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.id,a=t.type,r=t.shown,o=t.zaEnabled;r&&!e.shown&&this.container&&o&&E.default.setModule(this.container,{module:"CollectionDialogue"},{card:{card_type:"Content",content:{type:(0,T.convertType)(a),token:String(n)}}})}},{key:"render",value:function(){var e=this,t=this.state.status,n=R[t],a=n.title,o=n.tips,l=this.props,i=l.shown,u=l.onClose,c=l.defaultStatus,d=l.relations,f=l.onFavlistAdd,p=l.onLoad,b=l.isFetching,y=l.isDrained,E=l.items,C=l.zaEnabled,O=l.authRequired,N=l.isUserActive,T=r(l,["shown","onClose","defaultStatus","relations","onFavlistAdd","onLoad","isFetching","isDrained","items","zaEnabled","authRequired","isUserActive"]),P=!(y&&!E.length),I=(0,k.selectPairs)(T,Object.keys(g.default.propTypes)),M=I.selectedProps,S=void 0;return S="list"===t?P?m.default.createElement(w.default,{ref:function(t){e.container=t},items:E,isFetching:b,isDrained:y,relations:d,onAdd:this.handleAdd,onUpdate:this.handleUpdate,onLoad:p,zaEnabled:C}):m.default.createElement(v.ModalButtonGroup,null,m.default.createElement(h.default,{preset:"primary",color:"blue",onClick:this.handleAdd},"创建收藏夹"),m.default.createElement(h.default,{onClick:u},"取消")):m.default.createElement(_.default,{onSubmit:f,isActive:N,onBack:"add"===c?u:this.handleBack,authRequired:O}),m.default.createElement(g.default,s({onClose:u,title:a,subtitle:o&&o(P),buttonGroupOnly:!P,className:"FavlistsModal",size:"large"},M),i&&S)}}]),t}(f.Component);S.propTypes={id:d.default.oneOfType([d.default.string,d.default.number]),type:d.default.oneOf(["answer","article","pin"]),relations:d.default.object,onUpdateFav:d.default.func.isRequired,onFavlistAdd:d.default.func.isRequired,onFetchRelations:d.default.func,onClose:d.default.func.isRequired,shown:d.default.bool,zaEnabled:d.default.bool,authRequired:d.default.func,isUserActive:d.default.number},S.defaultProps={defaultStatus:"list",relations:{},authRequired:function(e){return e}};var j=function(){var e=this;this.state={status:this.props.defaultStatus},this.handleUpdate=function(t,n){var a=e.props,r=a.onUpdateFav,o=a.id,l=a.type,i=a.items,s=a.authRequired,u=a.isUserActive,c=i.find(function(e){return e.id===t})||{},d=[t,o,l,c.isPublic];return!n&&(0,I.default)(c.isPublic,u,s)?s(r).apply(void 0,d):r.apply(void 0,d)},this.handleAdd=function(){return e.setState({status:"add"})},this.handleBack=function(){return e.setState({status:"list"})}};t.default=S},1720:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),c=n(1),d=a(c),f=n(0),m=a(f),p=n(4),h=a(p),b=n(34),v=a(b),y=n(107),E=a(y),C=n(19),g=n(1288),O=a(g),_=function(e){function t(){o(this,t);var e=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={isPublic:!0,title:"",description:""},e.handleSubmit=e.handleSubmit.bind(e),e}return i(t,e),u(t,[{key:"handleSubmit",value:function(e){e.preventDefault();var t=this.state,n=t.isPublic,a=t.title,r=t.description;if(a){var o=this.props,l=o.onSubmit,i=o.onBack,s=o.authRequired,u=o.isActive,c={title:a,description:r,isPublic:n};(0,O.default)(n,u,s)?s(l)(c):(l(c),i())}}},{key:"render",value:function(){var e=this,t=this.state,n=t.title,a=t.description,o=t.isPublic,l=this.props.onBack;return m.default.createElement("form",{className:"Favlists-content",onSubmit:this.handleSubmit},m.default.createElement("div",{className:"Favlists-addItems"},m.default.createElement("div",{className:"Favlists-addItem"},m.default.createElement(v.default,{className:"Favlists-titleInput",placeholder:"收藏标题",onChange:function(t){var n=t.target.value;e.setState({title:n})}}),m.default.createElement("div",{className:"Favlists-inputTips"},m.default.createElement(E.default,{name:"收藏标题",current:n?n.length:0,max:20}))),m.default.createElement("div",{className:"Favlists-addItem"},m.default.createElement(v.default,{multiline:!0,className:"Favlists-descritionInput",placeholder:"收藏描述（可选）",onChange:function(t){var n=t.target.value;e.setState({description:n})},rows:5}),m.default.createElement("div",{className:"Favlists-inputTips"},m.default.createElement(E.default,{name:"收藏描述",current:a?a.length:0,max:60}))),m.default.createElement("div",{className:"Favlists-addItem"},m.default.createElement("label",{className:"Favlists-privacyOption"},m.default.createElement("input",{className:"Favlists-privacyOptionRadio",name:"isPublic",type:"radio",value:"true",checked:o,onChange:function(){return e.setState({isPublic:!0})}}),m.default.createElement("span",null,"公开"),m.default.createElement("span",{className:"Favlists-privacyOptionTips"},"有其他人关注此收藏夹时不可设置为私密")),m.default.createElement("label",{className:"Favlists-privacyOption"},m.default.createElement("input",{className:"Favlists-privacyOptionRadio",name:"isPublic",type:"radio",value:"false",checked:!o,onChange:function(){return e.setState({isPublic:!1})}}),m.default.createElement("span",null,"私密"),m.default.createElement("span",{className:"Favlists-privacyOptionTips"},"只有你自己可以查看这个收藏夹")))),m.default.createElement(C.ModalButtonGroup,s({direction:"horizontal"},r({},"","Favlists-mobileActions")),l&&m.default.createElement(h.default,{onClick:l},"返回"),m.default.createElement(h.default,{color:"blue",preset:"primary",type:"submit"},"确认创建")))}}]),t}(f.Component);_.propTypes={onSubmit:d.default.func.isRequired,onBack:d.default.func,authRequired:d.default.func},t.default=_},1721:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n(1),c=a(u),d=n(0),f=a(d),m=n(4),p=a(m),h=n(35),b=a(h),v=n(60),y=a(v),E=n(8),C=a(E),g=n(1722),O=a(g),_=function(e){function t(){var e,n,a,l;r(this,t);for(var i=arguments.length,s=Array(i),u=0;u<i;u++)s[u]=arguments[u];return n=a=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),a.items={},a.handleFavlistItemChange=function(e,t){C.default.trackEvent(a.items[e],{action:t?"UnCollect":"Collect",element:"Button",is_intent:!1}),a.props.onUpdate(e,t)},l=n,o(a,l)}return l(t,e),s(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.relations,a=t.items,r=t.isFetching,o=t.isDrained,l=t.onAdd,s=t.onLoad;return f.default.createElement("div",{className:"Favlists-content"},f.default.createElement(b.default,{isLocal:!0,isLoading:r,isDrained:o,onLoad:s,placeholder:f.default.createElement(y.default,{title:!0}),getContainer:function(e){return e},className:"Favlists-items"},a.map(function(t){return f.default.createElement(O.default,i({key:t.id,onChange:e.handleFavlistItemChange,checked:n[t.id]},t,{ref:function(n){e.items[t.id]=n}}))})),!a.length&&r||f.default.createElement("div",{className:"Favlists-actions"},f.default.createElement(p.default,{className:"Favlists-addButton",onClick:l,preset:"primary",color:"blue"},"创建收藏夹")))}}]),t}(d.Component);_.propTypes={isFecthing:c.default.bool,relations:c.default.object,onUpdate:c.default.func.isRequired,onAdd:c.default.func.isRequired,onLoad:c.default.func.isRequired,items:c.default.array.isRequired,isDrained:c.default.bool,authRequired:c.default.func},t.default=_},1722:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n(0),c=a(u),d=n(5),f=a(d),m=n(4),p=a(m),h=n(8),b=a(h),v=function(e){function t(){var e,n,a,l;r(this,t);for(var i=arguments.length,s=Array(i),u=0;u<i;u++)s[u]=arguments[u];return n=a=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),a.handleChange=function(){var e=a.props;(0,e.onChange)(e.id,a.props.checked)},l=n,o(a,l)}return l(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.zaEnabled,n=e.id;t&&b.default.setModule(this,{module:"CollectionItem"},{card:{card_type:"Content",content:{type:"Collection",token:String(n)}}})}},{key:"render",value:function(){var e=this.props,t=e.answerCount,n=e.title,a=e.isPublic,r=e.checked,o=void 0!==r&&r,l=o?{preset:"primary",color:"grey",children:"已收藏"}:{color:"blue",children:"收藏"};return c.default.createElement("div",{className:"Favlists-item"},c.default.createElement("div",{className:"Favlists-itemInner"},c.default.createElement("div",{className:"Favlists-itemName"},c.default.createElement("span",{className:"Favlists-itemNameText"},n),!1===a&&c.default.createElement("span",{className:"Favlists-itemIcon"},c.default.createElement(f.default,{name:"lock",width:14,height:14}))),c.default.createElement("div",{className:"Favlists-itemContent"},t," 条内容")),c.default.createElement(p.default,i({},l,{className:"Favlists-updateButton",onClick:this.handleChange})))}}]),t}(u.Component);t.default=v},1723:function(e,t){e.exports={attributes:{width:"72px",height:"58px",viewBox:"0 0 72 58"},content:'<defs>         <path d="M0.00434937116,11.7604183 C0.0014585125,11.8367351 0,11.9134174 0,11.9904392 L0,52.0095608 C0,55.3137533 2.68603825,58 5.99943435,58 L66.0005656,58 C69.3089213,58 72,55.317989 72,52.0095608 L72,11.9904392 C72,8.68624675 69.3139617,6 66.0005656,6 L31.1520961,6 L30.2346555,3.7077864 C29.4154984,1.66113281 26.9585394,0 24.7478675,0 L6.18638069,0 C2.86742525,0 0.139552484,2.68348852 0.0902454792,5.99373937 L0.00434937116,11.7604183 Z" id="path-1"></path>         <mask id="mask-2" maskContentUnits="userSpaceOnUse" maskUnits="objectBoundingBox" x="0" y="0" width="72" height="58" fill="white">             <use xlink:href="#path-1"></use>         </mask>     </defs>     <g id="空状态" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">         <g id="collection" transform="translate(-39.000000, -30.000000)" stroke="#E7EAF1">             <g transform="translate(39.000000, 30.000000)" id="Group-7">                 <g>                     <use id="Combined-Shape" mask="url(#mask-2)" stroke-width="6" xlink:href="#path-1"></use>                     <path d="M36.4126782,38.4800003 L30.2669271,41.2927815 C29.7656337,41.522213 29.4096881,41.2718295 29.4738593,40.716584 L30.2498317,34.0024302 L25.6755762,29.0266708 C25.3024658,28.6208107 25.4306014,28.2049135 25.9785012,28.0943637 L32.6038296,26.7575697 L35.9225353,20.8696 C36.1932338,20.3893332 36.6283715,20.3826781 36.9028211,20.8696 L40.2215268,26.7575697 L46.8468552,28.0943637 C47.3872665,28.2034026 47.5280608,28.6151866 47.1497802,29.0266708 L42.5755247,34.0024302 L43.3514971,40.716584 C43.4147912,41.2642406 43.0666691,41.5253922 42.5584293,41.2927815 L36.4126782,38.4800003 Z" id="Star" stroke-width="3"></path>                 </g>             </g>         </g>     </g>'}},1724:function(e,t){},1725:function(e,t){},1726:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),d=n(1),f=a(d),m=n(0),p=a(m),h=n(8),b=a(h),v=n(82),y=n(31),E=a(y),C=n(1727),g=a(C),O=n(1289),_=n(1290),N=n(69),w="请选择举报理由",k="举报",T=function(e){return e&&e.isBlocking},P=function(e){function t(){l(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.handleSubmit=function(t){var n=t.reason,a=t.customReason,r=e.props,o=r.onClose,l=r.urlToken,i=r.type;e.props.doReport(l,i,n,a),o()},e.handleContentChange=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w;e.setState({title:t,subtitle:n})},e.handleBlockUser=function(t){e.props.updateUserBlocking&&e.props.updateUserBlocking(t,!0)},e.handleClose=function(){e.props.zaEnabled&&b.default.trackEvent(e.container,{action:"Ok"},{button:{text:"知道了"}}),e.props.onClose()},e.state={title:k,subtitle:w},e}return s(t,e),c(t,[{key:"componentWillMount",value:function(){var e=this.props,t=e.talker,n=e.talkerId;n&&(T(t)?t.isBlocking||this.setState({blockVisabled:!0}):this.props.loadProfile(n))}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.talker,n=e.talker;T(t)||!T(n)||n.isBlocking||this.setState({blockVisabled:!0})}},{key:"componentDidUpdate",value:function(e){if(!e.shown&&this.props.shown){var t=this.props,n=t.type,a=t.id;b.default.setModule(this.container,{module:"ReportDialog"},{card:{card_type:"Content",content:o({type:(0,_.convertType)(n)},"comment"===n?"id":"token",String(a))}})}}},{key:"render",value:function(){var e=this,t=(0,v.omit)(this.props,"onClose"),n=t.shown,a=r(t,["shown"]),o=this.state,l=o.title,i=o.subtitle,s=o.blockVisabled,c=(0,O.selectPairs)(a,Object.keys(E.default.propTypes)),d=c.selectedProps,f=c.dropedProps;return p.default.createElement(E.default,u({title:l,subtitle:i,onClose:this.handleClose,className:"ReportModal"},d),n&&p.default.createElement(g.default,u({ref:function(t){e.container=t},onSubmit:this.handleSubmit,blockVisabled:s,onClose:this.handleClose,onContentChange:this.handleContentChange},f)))}}]),t}(m.Component);P.propTypes={onClose:f.default.func.isRequired,type:f.default.oneOf(N.ENTITY_TYPES).isRequired,urlToken:f.default.oneOfType([f.default.string,f.default.number]).isRequired,shown:f.default.bool.isRequired,talkerId:f.default.string,isColumnArticle:f.default.bool,isTipjarEnabled:f.default.bool,loadProfile:f.default.func,updateUserBlocking:f.default.func,doReport:f.default.func.isRequired,zaEnabled:f.default.bool},P.defaultTypes={zaEnabled:!1},t.default=P},1727:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),d=n(1),f=a(d),m=n(0),p=a(m),h=n(1728),b=n(1729),v=a(b),y=function(e){function t(){return l(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),c(t,[{key:"render",value:function(){var e=this.props,t=e.type,n=o(e,["type"]),a=void 0;return a="message"===t?h.NODES_FOR_MESSAGE:"member"===t?h.NODES_FOR_MEMBER:h.NODES.filter(function(e){return!e.types||e.types.includes(t)}),p.default.createElement(v.default,u({nodes:a.reduce(function(e,t){return u({},e,r({},t.id,t))},{})},n,{type:t}))}}]),t}(m.Component);y.propTypes={type:f.default.string.isRequired},t.default=y},1728:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NODES=[{id:0,text:"举报",childIds:[1,2,3,4,5,6]},{id:1,text:"侵犯我的权益",childIds:[16,10,17,11,14,13,37]},{id:10,reason:"abuse",types:["question"]},{id:11,reason:"mention",types:["question"]},{id:12,reason:"privacy",disabled:!0},{id:13,reason:"enterprise",disabled:!0},{id:14,reason:"copy",types:["question","answer","article","favlist","pin","book_review"],copywriter:{title:"原文链接或出处",placeholder:"填写原文链接或描述内容出处（必填）"},disabled:!0},{id:15,reason:"defamation",disabled:!0},{id:16,reason:"abuse",types:["answer","comment","article","favlist","pin","book_review"]},{id:17,reason:"intention",types:["answer","comment","article","pin","book_review"]},{id:2,text:"对知乎社区有害的内容",childIds:[20,21,22,23,24,25,26]},{id:20,reason:"abuse",text:"辱骂、歧视、挑衅等（不友善），泄露他人隐私",types:["question"]},{id:21,reason:"spam"},{id:22,reason:"illegality"},{id:23,reason:"politics"},{id:24,reason:"repost",types:["answer","article","favlist","pin","book_review"],copywriter:{title:"举报说明",placeholder:"描述内容出处或填写原文链接（必填）"},disabled:!0},{id:25,reason:"abuse",types:["answer","comment","article","favlist","pin","book_review"]},{id:26,reason:"temptation",types:["answer","article","pin","book_review"]},{id:3,text:"降低社区讨论质量的内容",childIds:[30,31,32,33,34,35,36],types:["question"]},{id:30,reason:"personal"},{id:31,reason:"ambiguity"},{id:32,reason:"worthless"},{id:33,reason:"rumour"},{id:34,reason:"suicide"},{id:35,reason:"medicine"},{id:36,reason:"superstition"},{id:37,reason:"oneself",disabled:!0},{id:4,reason:"abuse",types:["answer","comment","article","favlist","pin","book_review"]},{id:5,reason:"direction",types:["article"],shouldShow:function(e){return e.isColumnArticle}},{id:6,reason:"tipjar",types:["article"],shouldShow:function(e){return e.isTipjarEnabled}}],t.NODES_FOR_MESSAGE=[{id:0,text:"举报",childIds:[1,2,3]},{id:1,reason:"abuse"},{id:2,reason:"harassment"},{id:3,reason:"spam"}],t.NODES_FOR_MEMBER=[{id:0,text:"举报",childIds:[1,2,3,4,5,6]},{id:1,reason:"imitation"},{id:2,reason:"abuse",text:"发过辱骂我或他人的内容"},{id:3,reason:"illegality",text:"发过违反法律法规的内容"},{id:4,reason:"spam"},{id:5,reason:"politics",text:"发过政治敏感内容"},{id:6,reason:"profile"}]},1729:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),c=n(1),d=a(c),f=n(0),m=a(f),p=n(4),h=a(p),b=n(19),v=n(8),y=a(v),E=n(344),C=n(1730),g=a(C),O=n(1731),_=a(O),N=n(1732),w=a(N),k=n(1733);n(1734);var T=function(e){function t(e){o(this,t);var n=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.checkCustomReasonContent=function(){var e=n.state,t=e.activeId,a=e.customReason;if((14===t||24===t)&&a){var r=(0,k.isCustomReasonLegal)(a),o=r.isLegal,l=r.errorReason;if(!o)return n.setState({errorText:l}),!1}return!0},n.state={isBlock:!1,blockChecked:!1,activeId:0,parentId:null,selectedId:null,hasError:!1,errorText:""},n.menuItems={},n.handleItemSelect=n.handleItemSelect.bind(n),n.handleSubMenuEnter=n.handleSubMenuEnter.bind(n),n.handleDetailInput=n.handleDetailInput.bind(n),n.handleBackClick=n.handleBackClick.bind(n),n.handleSubmit=n.handleSubmit.bind(n),n.handleSubmitAppeal=n.handleSubmitAppeal.bind(n),n}return i(t,e),u(t,[{key:"componentWillUpdate",value:function(e,t){var n=this.state.activeId,a=t.activeId,r=this.props,o=r.nodes,l=r.onContentChange;if(a!==n){var i=o[a],s=i.reason,u=i.text,c=i.childIds,d=i.copywriter;l(u||E.ReportReasons[s],d&&d.title||(c?void 0:""))}}},{key:"handleItemSelect",value:function(e){var t=this.selectedId===e?null:e;this.setState({selectedId:t}),t&&this.props.zaEnabled&&y.default.trackEvent(this.menuItems[t],{action:"Select",element:"Menu"},{report:{id:e}})}},{key:"handleSubMenuEnter",value:function(e){this.setState(function(t){var n=t.activeId;return{activeId:e,parentId:n,selectedId:null}}),this.props.zaEnabled&&y.default.trackEvent(this.menuItems[e],{action:"Expand",element:"Menu"},{report:{id:e}})}},{key:"isSubmitEnabled",value:function(){var e=this.state,t=e.selectedId,n=e.activeId,a=e.customReason;return t||(14===n||24===n)&&a}},{key:"handleDetailInput",value:function(e){this.setState({customReason:e,errorText:""})}},{key:"handleBackClick",value:function(){var e=this.props.nodes,t=this.state.parentId,n=Object.keys(e).find(function(n){var a=e[n].childIds;return a&&a.includes(t)});this.setState({activeId:t,parentId:n&&Number(n),selectedId:null,hasWarning:!1,customReason:"",errorText:""}),this.props.zaEnabled&&y.default.trackEvent(this,{action:"Back",element:"Button"},{report:{id:this.state.activeId}})}},{key:"handleSubmitAppeal",value:function(){var e="",t=this.state.activeId,n=this.props,a=n.type,r=n.urlToken;13===t?e="org":37===t&&(e="people"),window.open("//www.zhihu.com/account/complaints/"+e+"/"+a+"/"+r)}},{key:"handleSubmit",value:function(){var e=this.state,t=e.selectedId,n=e.customReason,a=e.activeId,r=e.blockChecked;if(this.isSubmitEnabled()&&this.checkCustomReasonContent()){var o=this.props,l=o.nodes,i=o.onBlockUser,s=o.talkerToken,u=o.onSubmit,c=l[t||a],d=c.reason,f=c.id;u({reason:d,customReason:n}),r&&i(s),this.props.zaEnabled&&y.default.trackEvent(this,{action:"Report",element:"Button"},{report:{id:f}})}}},{key:"render",value:function(){var e=this,t=this.props,n=t.nodes,a=r(t,["nodes"]),o=this.state,l=o.activeId,i=o.parentId,u=o.selectedId,c=o.blockVisibled,d=o.blockChecked,f=o.errorText,p=n[l],v=p.reason,y=p.childIds,E=p.copywriter,C=Boolean(y),O=14===l||24===l,N=C&&m.default.createElement("div",{className:"ReportMenu-inner"},y.map(function(e){return n[e]}).filter(function(e){return e&&(!e.shouldShow||e.shouldShow(a))}).map(function(t){return m.default.createElement(g.default,s({ref:function(n){e.menuItems[t.id]=n},key:t.id},t,{isSelected:u===t.id,onSubMenuEnter:e.handleSubMenuEnter,onItemSelect:e.handleItemSelect}))}))||O&&m.default.createElement(w.default,{onDetailInput:this.handleDetailInput,copywriter:E,errorText:f,checkCustomReasonContent:this.checkCustomReasonContent})||m.default.createElement(_.default,{reason:v}),k=C&&c&&m.default.createElement("label",{className:"ReportMenu-check",htmlFor:"block"},m.default.createElement("input",{type:"checkbox",name:"block",checked:d,onChange:function(t){return e.setState({blockChecked:t.target.checked})}}),"同时将此人屏蔽");return m.default.createElement("div",{className:"ReportMenu"},N,m.default.createElement(b.ModalButtonGroup,{direction:"horizontal"},k,"number"==typeof i&&m.default.createElement(h.default,{onClick:this.handleBackClick},"返回"),C||O?m.default.createElement(h.default,{className:"ReportMenu-button",disabled:!this.isSubmitEnabled(),onClick:this.handleSubmit,color:"blue",preset:"primary"},"举报"):m.default.createElement(h.default,{onClick:this.handleSubmitAppeal,preset:"primary",color:"blue"},"进入诉求提交页面")))}}]),t}(f.Component);T.propTypes={nodes:d.default.object.isRequired,onContentChange:d.default.func.isRequired,onSubmit:d.default.func.isRequired,talkerToken:d.default.string,isColumnArticle:d.default.bool,isTipjarEnabled:d.default.bool,errorText:d.default.string},t.default=T},1730:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s=n(1),u=a(s),c=n(0),d=a(c),f=n(5),m=a(f),p=n(344),h=function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.handleClick=e.handleClick.bind(e),e}return l(t,e),i(t,[{key:"handleClick",value:function(){var e=this.props,t=e.id,n=e.reason,a=e.disabled,r=e.onSubMenuEnter,o=e.onItemSelect;n&&!a?o(t):r(t)}},{key:"render",value:function(){var e=this.props,t=e.reason,n=e.text,a=e.disabled,r=e.isSelected,o=e.id,l=n||p.ReportReasons[t];return Boolean(t&&!a)?d.default.createElement("label",{className:"ReportMenu-item",htmlFor:t},d.default.createElement("div",{className:"ReportMenu-itemValue"},l),d.default.createElement("input",{className:"ReportMenu-itemCheck",type:"radio",name:"report",value:o,id:t,checked:r,onChange:this.handleClick}),d.default.createElement(m.default,{className:"ReportMenu-itemCheckIcon",width:16,height:16,name:"checkRound"})):d.default.createElement("button",{className:"ReportMenu-item",onClick:this.handleClick},d.default.createElement("span",{className:"ReportMenu-itemValue"},l),d.default.createElement(m.default,{name:"arrowRight",width:11,height:11}))}}]),t}(c.Component);h.propTypes={id:u.default.number.isRequired,reason:u.default.string,text:u.default.string,disabled:u.default.bool,isSelected:u.default.bool,onSubMenuEnter:u.default.func.isRequired,onItemSelect:u.default.func.isRequired},t.default=h},1731:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s=n(1),u=a(s),c=n(0),d=a(c),f=n(344),m=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,e),i(t,[{key:"render",value:function(){switch(this.props.reason){case"oneself":return d.default.createElement("div",{className:"ReportMenu-inner"},d.default.createElement("div",{className:"ReportMenu-paragraph"},"当您发现知乎上有关于您个人的侵权内容时，您可通过此渠道向知乎提交举报诉求。"),d.default.createElement("div",{className:"ReportMenu-paragraph"},"根据",d.default.createElement("a",{className:"ReportMenu-link",href:"https://www.zhihu.com/terms#sec-report",target:"_blank"},"知乎侵权举报规范"),"，您需要向我们提交您的个人信息，其中包括身份证明。如您确认已准备齐全，可点击下方按钮进入诉求提交页。"),d.default.createElement("div",{className:"ReportMenu-paragraph ReportMenu-paragraph--light"},"如果您举报的仅仅是辱骂等不友善内容，无需提供材料，可返回上一步点击「辱骂、歧视、挑衅等（不友善）」直接举报。"));case"privacy":return d.default.createElement("div",{className:"ReportMenu-inner"},d.default.createElement("div",{className:"ReportMenu-paragraph"},"您好，当您发现知乎上有泄漏您隐私的内容时，您可向知乎进行举报。 请您把以下内容通过邮件发送到 ",d.default.createElement("a",{className:"ReportMenu-link",href:"mailto:i@zhihu.com"},"i@zhihu.com")," 邮箱，我们会尽快处理。"),d.default.createElement("ul",{className:"ReportMenu-paragraph"},d.default.createElement("li",null,"1. 您认为哪些内容泄露了您的隐私？（请在邮件中列出您举报的内容、链接地址，并给出简短的说明）"),d.default.createElement("li",null,"2. 您是谁？（身份证明材料，可以是身份证或护照等证件）")),d.default.createElement("div",{className:"ReportMenu-paragraph ReportMenu-paragraph--light"},"邮件格式请参考",d.default.createElement("a",{className:"ReportMenu-link--light",href:"https://www.zhihu.com/terms#sec-report",target:"_blank"},"这里"),"； 如果仅仅是辱骂等不友善内容，无需提供材料，可返回上一步点击「",f.ReportReasons.abuse,"」直接举报。"));case"enterprise":return d.default.createElement("div",{className:"ReportMenu-inner"},d.default.createElement("div",{className:"ReportMenu-paragraph"},"当您发现知乎上有关于您企业的侵权等内容时，知乎建议您先尝试与作者沟通解决问题。 如果您无法联系到作者，您也可通过此渠道向知乎提出诉求。"),d.default.createElement("div",{className:"ReportMenu-paragraph"},"根据",d.default.createElement("a",{className:"ReportMenu-link",href:"https://www.zhihu.com/terms#sec-report",target:"_blank"},"知乎侵权举报规范"),"，您需要向我们提交您企业和个人的证明材料。如您确认已经准备齐全。可点击下方按钮进入诉求提交页。"),d.default.createElement("div",{className:"ReportMenu-paragraph ReportMenu-paragraph--light"},"如果您举报的仅仅是辱骂企业或辱骂企业员工的内容，无需提供材料，可返回上一步点击「辱骂、歧视、挑衅等（不友善）」直接举报。"));case"defamation":return d.default.createElement("div",{className:"ReportMenu-inner"},d.default.createElement("div",{className:"ReportMenu-paragraph"},"您好，当您发现知乎上有诽谤您的内容时，您可以向知乎进行举报。 请您把以下内容通过邮件发送到",d.default.createElement("a",{className:"ReportMenu-link",href:"mailto:i@zhihu.com"}," i@zhihu.com "),"邮箱，我们会尽快处理。"),d.default.createElement("ul",{className:"ReportMenu-paragraph"},d.default.createElement("li",null,"1. 您举报的内容以及侵犯了您什么权益？（请在邮件中列出您举报的内容、链接地址，并给出简短的说明）"),d.default.createElement("li",null,"2. 您是谁？（身份证明材料，可以是身份证或护照等证件）")),d.default.createElement("div",{className:"ReportMenu-paragraph ReportMenu-paragraph--light"},"邮件格式请参考 ",d.default.createElement("a",{className:"ReportMenu-link--light",href:"https://www.zhihu.com/terms#sec-report",target:"_blank"},"这里")," ； 如果仅仅是辱骂等不友善内容，无需提供材料，可返回上一步点击「",f.ReportReasons.abuse,"」直接举报。"));default:return null}}}]),t}(c.Component);m.propTypes={reason:u.default.string.isRequired},t.default=m},1732:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s=n(1),u=a(s),c=n(0),d=a(c),f=n(34),m=a(f),p=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,e),i(t,[{key:"render",value:function(){var e=this.props,t=e.copywriter.placeholder,n=e.onDetailInput,a=e.errorText,r=e.checkCustomReasonContent;return d.default.createElement("div",{className:"ReportMenu-inner"},d.default.createElement(m.default,{multiline:!0,grey:!0,rows:5,className:"ReportMenu-textarea",placeholder:t,onChange:function(e){return n(e.target.value)},onBlur:r}),d.default.createElement("div",{className:"ReportMenu-errorText"},a))}}]),t}(c.Component);p.propTypes={onDetailInput:u.default.func.isRequired,copywriter:u.default.object,errorText:u.default.string},t.default=p},1733:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCustomReasonLegal=void 0;var a=n(344);t.isCustomReasonLegal=function(e){var t=/[\u4e00-\u9fa5a-zA-Z0-9]/;return e.length>1e3?{isLegal:!1,errorReason:a.ReportMessage.contentTooLong}:t.test(e)?{isLegal:!0,errorReason:""}:{isLegal:!1,errorReason:a.ReportMessage.contentIllegal}}},1734:function(e,t){},1735:function(e,t){},1736:function(e,t){},1737:function(e,t){},1738:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){var n=t.commentId,a=e.entities.comments,r=e.comments.conversation,o=r[n]||{isFetching:!1,isDrained:!1,ids:[]};return{isFetching:o.isFetching,isDrained:o.isDrained,comments:o.ids.map(function(e){return a[e]}),openComment:a[n]}}Object.defineProperty(t,"__esModule",{value:!0});var s,u,c=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),d=n(1),f=a(d),m=n(0),p=a(m),h=n(3),b=n(35),v=n(31),y=a(v),E=n(16),C=n(346),g=n(1216),O=a(g),_=n(1291),N=a(_),w=n(1292),k=a(w),T=(u=s=function(e){function t(e,n){r(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return a.load=a.load.bind(a),a.addComment=n.authRequired(a.addComment.bind(a),void 0,E.NOTIFICATION_TYPE_COMMENT),a}return l(t,e),c(t,[{key:"componentDidMount",value:function(){this.load()}},{key:"load",value:function(){this.props.dispatch((0,C.loadConversation)(this.props.commentId))}},{key:"addComment",value:function(e,t){var n=this.props,a=n.type,r=n.parent,o=n.commentId,l=n.dispatch,i=[a,r.id,e,t.id,o];l(C.addComment.apply(void 0,i))}},{key:"render",value:function(){var e=this.props,t=e.onItemLike,n=e.onItemDelete,a=e.onItemFeature,r=e.onItemApprove,o=e.onItemCollapse,l=e.onItemDislike,i=e.onNavBack,s=e.canOperateItem,u=e.isFetching,c=e.comments,d=e.commentNeedsReview,f=e.openComment.collapsed,m=e.parent,h=e.parent.canComment;h=void 0===h?{status:!0}:h;var v=h.status,E=h.reason,C=e.commentPattern,g=this.context.currentUser,_=Boolean(g&&c.find(function(e){return e.author&&e.author.member.urlToken===g.urlToken})),w=void 0,T=void 0;_&&(w=c.filter(function(e){return e.author&&e.author.member.urlToken!==g.urlToken}),T=w[w.length-1]);var P=void 0;return u&&!c.length?P=p.default.createElement(b.PlaceHolder,{className:"CommentItem",small:!0}):c.length&&(P=c.map(function(e,i){return p.default.createElement(N.default,{key:i,isConversation:!0,commentNeedsReview:d,canOperate:s,parent:m,comment:e,onLike:t,onDelete:n,onFeature:a,onApprove:r,onCollapse:o,onDislike:l,collapsedShown:f})})),"bottom"===C?p.default.createElement(y.default,{size:"fullPage",onClose:i},p.default.createElement("div",{className:"Comments"},p.default.createElement(k.default,{isConversation:!0,commentPattern:C}),p.default.createElement("div",{className:"CommentList"},P))):p.default.createElement("div",{className:"Comments"},p.default.createElement(k.default,{isConversation:!0,onNavBack:i}),p.default.createElement("div",{className:"CommentList"},P),T&&(v?p.default.createElement(O.default,{className:"Comments-footer",replyTo:T,commentNeedsReview:d,onSubmit:this.addComment}):p.default.createElement("div",{className:"Comments-disabledText"},E)))}}]),t}(m.Component),s.propTypes={commentId:f.default.number.isRequired,type:f.default.string,parent:f.default.object.isRequired,commentNeedsReview:f.default.bool},s.contextTypes={currentUser:f.default.object,authRequired:f.default.func.isRequired},u);t.default=(0,h.connect)(i)(T)},1739:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(){this.payments={},this.chosePaymentName=null,this.codeUrl="",this.qrLoaded=!1,this.need=null,this.passcode="",this.needSMS=!1,this.smsTimer=0,this.isInProgress=!1,this.error=null}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),d=n(0),f=a(d),m=n(1),p=a(m),h=n(2),b=a(h),v=n(50),y=a(v),E=n(5),C=a(E),g=n(4),O=a(g),_=n(1740),N=a(_),w=n(1742),k=a(w),T=n(39),P=a(T);n(1744);var I=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onPasscodeFocus=function(){n.state.error&&(n.setState({error:null}),6===n.state.passcode.length&&n.setState({passcode:""}))},n.onPasscodeInput=function(e){"object"===(void 0===e?"undefined":u(e))&&(e=e.target.value),n.setState({passcode:e})},n.onPasscodeFinish=function(e){n.tpass.blur(),n.payWithBalance(e)},n.onSendSMSCode=function(){n.props.trade.resendSMSCode(function(){n.startSMSTimer(),n.smsInput.focus()},function(e){n.setState({error:e})})},n.onQrLoad=function(){n.setState({qrLoaded:!0})},n.onBalanceFormSubmit=function(e){e.preventDefault(),n.payWithBalance(n.state.passcode)},n.setPayments=function(e){n.setState({payments:e})},n.confirmPayment=function(){var e=n.state,t=e.choseName,a=e.payments,r=n.props.onConfirmPayment,o=t;t||(o=a.balance&&a.balance.enable?"balance":"wechat"),r(!o),n.setState({chosePaymentName:o}),n.props.trade["wechat"===o?"initWechatPay":"initBalancePay"]()},n.pid=0,n.smsTimer=null,n.state=new i,n.isInWechat=e.ua.Wechat,n}return l(t,e),c(t,[{key:"componentWillMount",value:function(){var e=this.props.trade;this.getPaymentsList(e),this.initListeners(e)}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.trade!==this.props.trade&&(this.setState(new i),setTimeout(function(){t.getPaymentsList(e.trade)},300),this.initListeners(e.trade))}},{key:"componentWillUnmount",value:function(){window.clearInterval(this.smsTimer),this.props.trade.dispose()}},{key:"getPaymentsList",value:function(e){var t=this;if(e){var n=this.pid+=1;e.getPaymentsList(function(e){t.pid===n&&t.setPayments(e)})}}},{key:"initListeners",value:function(e){var t=this;e&&e.on("payInited",function(e,n){t.setState(s({},n))}).on("paySuccess",function(){t.setState({isInProgress:!1,error:null}),t.props.onSuccess()}).on("payCancel",function(){t.setState({isInProgress:!1,chosePaymentName:null})}).on("payFail",function(e){var n=e;"object"!==(void 0===e?"undefined":u(e))||e instanceof Error||(n=e.message),t.setState({isInProgress:!1,error:n}),t.props.onFail(e)}).on("needSMS",function(e){t.setState({isInProgress:!1,error:null,needSMS:e.message,passcode:""})}).on("needWechatCode",function(){t.props.onError("needWechatCode")}).on("error",function(e,n){t.props.onError(e,n)})}},{key:"startSMSTimer",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:60;window.clearInterval(this.smsTimer),this.setState({smsTimer:t}),this.smsTimer=window.setInterval(function(){t-=1,t<=0?(window.clearInterval(e.smsTimer),e.smsTimer=null,e.setState({smsTimer:0})):e.setState({smsTimer:t})},1e3)}},{key:"payWithBalance",value:function(e){return 6!==e.length?(this.setState({error:"请输入 6 位支付密码"}),!1):(this.setState({isInProgress:!0,error:null}),this.props.trade.payWithBalance(e))}},{key:"renderPaymentsList",value:function(){var e=this,t=this.state,n=t.payments,a=t.chosePaymentName,r=t.choseName,o=this.props.trade;if(a)return null;var l=n.balance&&n.balance.amount,i=o.info.total,s=n.wechat&&n.wechat.enable,u=n.balance&&n.balance.enable,c=n.balance&&!n.balance.enable,d=l>=i?"使用余额（剩余 "+(l/100).toFixed(2)+"）":"微信支付",m=l>=i?"wallet":"wechatPayment",p="PaymentItem-"+(l>=i?"wallet":"wechatPayment");r&&(d="wechat"===r?"微信支付":"使用余额（剩余 "+(l/100).toFixed(2)+"）",m="wechat"===r?"wechatPayment":"wallet",p="PaymentItem-"+("wechat"===r?"wechatPayment":"wallet"));var h=f.default.createElement("div",null,f.default.createElement(C.default,{name:m,className:p}),f.default.createElement(O.default,{className:"Payment-Popover"},d),f.default.createElement(C.default,{className:"Select-arrow",name:"select"}));return f.default.createElement("div",{className:"PaymentsList"},f.default.createElement("span",{className:"Payment-Topline"}),f.default.createElement("span",{className:"PaymentWay"},"支付方式"),f.default.createElement(P.default,{placeholder:h},f.default.createElement(y.default,{plain:!0,className:"Payment-select",listClassName:"Payment-select-list",targetClassName:"Popover-targetContainer-verification",text:l>=i?"使用余额（剩余 "+(l/100).toFixed(2)+"）":"微信支付",menuToggler:h,onChange:function(t){"disabled"!==t&&e.setState({choseName:t})}},u&&f.default.createElement(v.Option,{value:"balance",className:"PaymentItem"},f.default.createElement(C.default,{name:"wallet",className:"PaymentItem-wallet"}),"使用余额（剩余 "+(l/100).toFixed(2)+"）"),c&&f.default.createElement(v.Option,{value:"disabled",className:"PaymentItem PaymentItem--disabled"},f.default.createElement(C.default,{name:"wallet",className:"PaymentItem-wallet"}),"使用余额（剩余 "+(l/100).toFixed(2)+"）"),s&&f.default.createElement(v.Option,{value:"wechat",className:"PaymentItem"},f.default.createElement(C.default,{name:"wechatPayment",className:"PaymentItem-wechatPayment"}),"微信支付"))),f.default.createElement("span",{className:"Payment-Bottomline"}),f.default.createElement(O.default,{className:"Payment-CheckedButton",onClick:this.confirmPayment},"确认支付"))}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,a=t.trade,r=this.state,o=r.payments,l=r.chosePaymentName,i=r.codeUrl,s=r.needSMS,u=r.isInProgress;return a?f.default.createElement("div",{className:(0,b.default)("Payment",n)},Object.keys(o).length?this.renderPaymentsList():f.default.createElement("div",{className:"Payment-placeholder"},f.default.createElement(k.default,null)),"wechat"===l&&f.default.createElement("div",{className:"Payment-wechatPay"},f.default.createElement("div",{className:"Payment-wechatPayTitle"},f.default.createElement("i",{className:"icon icon-ic_wechatpay PaymentIconWechat"}),"微信支付"),!this.isInWechat&&f.default.createElement("div",null,"使用微信扫描二维码完成支付"),this.state.qrLoaded?f.default.createElement("span",{className:"Payment-qrWrapper"},f.default.createElement("img",{role:"presentation",src:"//www.zhihu.com/qrcode?url="+i,width:"150",height:"150"})):f.default.createElement("div",{className:"Payment-qrPlaceholder"},f.default.createElement(k.default,null),!this.isInWechat&&f.default.createElement("div",null,"正在生成二维码"),i&&f.default.createElement("img",{role:"presentation",src:"//www.zhihu.com/qrcode?url="+i,width:"1",height:"1",onLoad:this.onQrLoad}))),"balance"===l&&f.default.createElement("form",{onSubmit:this.onBalanceFormSubmit,className:"Payment-balancePay"},f.default.createElement("div",{className:"Payment-balancePayTitle"},f.default.createElement("i",{className:"icon icon-wallet PaymentIconWallet"}),"余额支付"),!s&&f.default.createElement("div",null,f.default.createElement("div",{className:"Payment-description"},"请输入 6 位数知乎支付密码，用于支付验证。"),f.default.createElement(N.default,{chars:this.state.passcode,onFocus:this.onPasscodeFocus,onChange:this.onPasscodeInput,maskChar:!0,onFinish:this.onPasscodeFinish,className:(0,b.default)("Payment-tpass",{"Payment-errorInput":this.state.error,"Payment-progressing":u}),autoFocus:!0,ref:function(t){e.tpass=t}},u&&f.default.createElement(k.default,{className:"Payment-balancePaySpinner"}))),Boolean(s)&&f.default.createElement("div",{className:"Payment-balancePaySms"},f.default.createElement("div",{className:"Payment-balancePaySmsText"},String(s)),f.default.createElement("input",{onChange:this.onPasscodeInput,value:this.state.passcode,className:(0,b.default)("Payment-sms","SimpleInput",{"Payment-errorInput":this.state.error}),type:"text",pattern:"\\d{6}",minLength:"6",maxLength:"6",title:"验证码应为 6 位数字",placeholder:"输入 6 位数验证码",required:!0,autoFocus:!0,ref:function(t){e.smsInput=t}}),this.state.smsTimer?f.default.createElement("button",{className:"Payment-sendSms",type:"button",disabled:!0},this.state.smsTimer," 秒后可重发"):f.default.createElement("button",{onClick:this.onSendSMSCode,className:"Payment-sendSms",type:"button"},"发送验证码")),f.default.createElement("div",{className:"Payment-balancePayFooter"},f.default.createElement("p",{className:"Payment-errorTip",style:{visibility:this.state.error?"visible":"hidden"}},this.state.error),Boolean(s)&&f.default.createElement(O.default,{color:"blue",disabled:u,className:"Payment-balancePayConfirmBtn",type:"submit"},"确认")),!s&&f.default.createElement("div",{className:"Payment-balancePayForget"},"如果忘记密码请邮件联系 ",f.default.createElement("email",{className:"Payment-email"},"i@zhihu.com")))):f.default.createElement("div",{className:(0,b.default)("Payment",n)},f.default.createElement("div",{className:"Payment-placeholder Payment-placehoder--empty"},f.default.createElement(k.default,null)))}}]),t}(f.default.Component);I.propTypes={trade:p.default.object,autoChooseSinglePayment:p.default.bool,onSuccess:p.default.func.isRequired,onFail:p.default.func,onError:p.default.func,onConfirmPayment:p.default.func},I.defaultProps={trade:null,onSuccess:function(){},onFail:function(){},onError:function(){},autoChooseSinglePayment:!0,className:""},t.default=I},1740:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){return e?t?!0===t?"":t:e:""}function s(e){for(var t,n=e.length,a=e.chars,r=e.maskChar,o=[],l=0;l<n;l+=1)t=a[l],o.push(d.default.createElement("span",{className:(0,h.default)("TPassBox",{"TPassBox-mask":t&&Boolean(r)}),key:l},i(t,r)));return d.default.createElement("span",{className:"TPassBoxes"},o)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),c=n(0),d=a(c),f=n(1),m=a(f),p=n(2),h=a(p);n(1741);var b={backspace:8,tab:9,enter:13,0:48,9:57},v=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onInputFocus=n.onInputFocus.bind(n),n.onInputChange=n.onInputChange.bind(n),n.onKeyDown=n.onKeyDown.bind(n),n}return l(t,e),u(t,[{key:"onInputFocus",value:function(e){e.target.value=e.target.value,this.props.onFocus()}},{key:"onInputChange",value:function(e){var t=String(e.target.value);if(t){t=t[t.length-1];var n=this.props.chars,a=this.props.length;n.length===a?n=n.replace(/.$/,t):n+=t,this.props.onChange(n),n.length===a&&this.props.onFinish(n)}}},{key:"onKeyDown",value:function(e){var t=e.keyCode;if(!e.metaKey&&!e.ctrlKey&&t!==b.tab&&t!==b.enter){var n=this.props.chars;t===b.backspace?(n=n.slice(0,-1),this.props.onChange(n)):(t<b[0]||t>b[9])&&(e.preventDefault(),this.props.onError(e))}}},{key:"focus",value:function(){this.refs.input.focus()}},{key:"blur",value:function(){this.refs.input.blur()}},{key:"render",value:function(){var e=this.props,t=e.length,n=e.chars,a=e.maskChar,r=e.autoFocus,o=e.className,l=e.children,i=n.length===t?t-1:n.length,u=n[i]||"";return d.default.createElement("label",{className:(0,h.default)("TPass",o)},d.default.createElement("span",{className:"TPass-wrapper"},d.default.createElement(s,{length:t,chars:n,maskChar:a}),d.default.createElement("input",{className:"TPass-input",value:u,style:{left:60*i},onFocus:this.onInputFocus,onChange:this.onInputChange,onKeyDown:this.onKeyDown,onPaste:function(e){return e.preventDefault()},type:"number",min:"0",max:"9",pattern:"[0-9]*",autoFocus:r,ref:"input"})),l)}}]),t}(d.default.Component);v.defaultProps={length:6,chars:"",maskChar:!1,autoFocus:!1,onFocus:function(){},onChange:function(){},onError:function(){},onFinish:function(){}},v.propTypes={length:m.default.number,chars:m.default.string,maskChar:m.default.oneOfType([m.default.bool,m.default.string]),autoFocus:m.default.bool,onFocus:m.default.func,onChange:m.default.func,onError:m.default.func,onFinish:m.default.func,className:m.default.string,children:m.default.node},t.default=v},1741:function(e,t){},1742:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,s,u=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),c=n(0),d=a(c),f=n(1),m=a(f),p=n(2),h=a(p);n(1743);var b=(s=i=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,e),u(t,[{key:"render",value:function(){var e=this.props;return d.default.createElement("div",{className:(0,h.default)("Spinner",e)},d.default.createElement("i",{className:"Spinner-loading"}))}}]),t}(c.Component),i.propTypes={className:m.default.string},s);t.default=b},1743:function(e,t){},1744:function(e,t){},1745:function(e,t,n){"use strict";function a(e,t){return o&&e&&e!==o&&t(new Error("A pay-sdk from different source has been load")),o=e,window.zhihu&&window.zhihu.pay?window.zhihu.pay.ready(t):(l||(l=(0,r.loadScript)(e)),l.then(function(){return window.zhihu.pay.ready(t)},function(e){t(e),l=null}))}Object.defineProperty(t,"__esModule",{value:!0}),t.loadPaySDK=a;var r=n(220),o="",l=null},1746:function(e,t){}});
//# sourceMappingURL=main.0.308a534e28ab6b7a0b46.js.map